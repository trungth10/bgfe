(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69d949da"],{"017b":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("base-header",{staticClass:"pb-6 pb-8 pt-5 pt-md-7",attrs:{type:"gradient-success"}}),o("div",{staticClass:"ml-4 mr-4 mb-4 p-4 mt--7"},[o("product-table")],1)],1)},a=[],n=o("21a3"),r={components:{ProductTable:n["a"]},created:function(){var t=this.$session.get("user-info");if(void 0!=t){var e=t.brandId;void 0!=e?this.$store.commit("product/setBrandId",e):this.$router.push("/login").catch((function(){}))}else this.$router.push("/login").catch((function(){}))},methods:{},props:{},watch:{},data:function(){return{}}},s=r,l=o("2877"),c=Object(l["a"])(s,i,a,!1,null,null,null);e["default"]=c.exports},"01e2":function(t,e,o){},"0209":function(t,e,o){"use strict";o("62b4")},"088d":function(t,e,o){},"09bb":function(t,e,o){"use strict";o("3546")},"0b20":function(t,e,o){},1421:function(t,e,o){},"144e":function(t,e,o){},"16e4":function(t,e,o){"use strict";o("e815")},"18a0":function(t,e,o){"use strict";o("fc32")},"1f6d":function(t,e,o){"use strict";o("088d")},"28d8":function(t,e,o){"use strict";o("1421")},"2d17":function(t,e,o){"use strict";o("fe55")},"306d":function(t,e,o){"use strict";o("e38d")},"34ad":function(t,e,o){"use strict";o("fc72")},3546:function(t,e,o){},"3b23":function(t,e,o){"use strict";o("f159")},"400b":function(t,e,o){},"44de1":function(t,e,o){"use strict";o("c78a")},"45fc":function(t,e,o){"use strict";var i=o("23e7"),a=o("b727").some,n=o("a640"),r=o("ae40"),s=n("some"),l=r("some");i({target:"Array",proto:!0,forced:!s||!l},{some:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},4739:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("el-card",{attrs:{shadow:"never"}},[t.voucherInfo.voucherId!=t.$ENV.GUID.EMPTY?o("el-row",[o("el-card",{staticClass:"pb-3",attrs:{shadow:""}},[o("el-col",{attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Voucher Code ")])]),o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(t.voucherInfo.voucherCode)+" ")])],1)]),o("el-col",{attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Promotion: ")])]),null==t.voucherInfo.promotion?o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"danger"}},[t._v(" N/A ")]):t._e(),null!=t.voucherInfo.promotion?o("label",{staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.promotion.promotionName)))]):t._e()],1)]),o("el-col",{attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Promo Code ")])]),t.voucherInfo.promotion?t._e():o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"danger"}},[t._v(" N/A ")]),t.voucherInfo.promotion?o("el-tag",{staticClass:"tag-custom",attrs:{size:"medium",effect:"dark",type:"warning"}},[t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.promotion.promotionCode))+" ")]):t._e()],1)])],1)],1):t._e(),t.voucherInfo.voucherId!=t.$ENV.GUID.EMPTY?o("el-row",{staticClass:"mt-4"},[o("el-card",{staticClass:"pb-3",attrs:{shadow:""}},[o("el-col",{attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Redemp Date ")])]),o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(t._f("formatDate")(t.voucherInfo.redempedDate))+" ")])],1)]),o("el-col",{attrs:{span:16}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Channel ")])]),o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.channel.channelName))+" ")])],1)]),o("el-col",{staticClass:"mt-3",attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Customer: ")])]),t._v(t._s(t._f("valueFilterNull")(t.voucherInfo.membership.fullname))+" ")])]),o("el-col",{staticClass:"mt-3",attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Email: ")])]),t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.membership.email))+" ")])]),o("el-col",{staticClass:"mt-3",attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Phone number: ")])]),t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.membership.phoneNumber))+" ")])])],1)],1):t._e(),t.voucherInfo.voucherId!=t.$ENV.GUID.EMPTY?o("el-row",{staticClass:"mt-4"},[o("el-card",{staticClass:"pb-3",attrs:{shadow:""}},[o("el-col",{staticClass:"mb-3",attrs:{span:8}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Use Date ")])]),o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(t._f("formatDate")(t.voucherInfo.usedDate))+" ")])],1)]),o("el-col",{staticClass:"mb-3",attrs:{span:16}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Store ")])]),t.voucherInfo.store?o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(t._f("valueFilterNull")(t.voucherInfo.store.storeName))+" ")]):t._e()],1)]),null!=t.orderInfo?o("el-card",{staticClass:"pb-3",attrs:{shadow:"never"}},[o("el-col",{attrs:{span:12}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Order ID ")])]),t.orderInfo?o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"info"}},[t._v(" "+t._s(t._f("valueFilterNull")(t.orderInfo.CustomerOrderInfo.Id))+" ")]):t._e()],1)]),o("el-col",{attrs:{span:12}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Order Date ")])]),t.orderInfo?o("el-tag",{staticClass:"tag-custom",attrs:{effect:"plain",size:"medium",type:"warning"}},[t._v(" "+t._s(t._f("formatDateTime")(t.orderInfo.CustomerOrderInfo.BookingDate))+" ")]):t._e()],1)]),null!=t.orderInfo?o("el-col",{attrs:{span:24}},[null!=t.orderInfo?o("el-table",{staticClass:"mt-3",attrs:{height:"200",border:"","cell-class-name":"myWordClass",data:t.orderInfo.CustomerOrderInfo.CartItems}},[o("el-table-column",{attrs:{type:"index",width:"70"}}),o("el-table-column",{staticStyle:{"word-break":"break-word"},attrs:{label:"Name",prop:"ProductName"}}),o("el-table-column",{attrs:{label:"Code",prop:"ProductCode"}}),o("el-table-column",{attrs:{label:"Image"},scopedSlots:t._u([{key:"default",fn:function(t){return[o("img",{attrs:{src:t.row.UrlImg,alt:"Image of product",width:"40",height:"40"}})]}}],null,!1,3062820755)}),o("el-table-column",{attrs:{label:"Quantity",prop:"Quantity"}}),o("el-table-column",{attrs:{label:"Price",prop:"UnitPrice"}}),o("el-table-column",{attrs:{label:"Subtotal",prop:"SubTotal"}}),o("el-table-column",{attrs:{label:"Discount",prop:"Discount"}}),o("el-table-column",{attrs:{label:"Total",prop:"Total"}})],1):t._e()],1):t._e(),o("el-col",{staticClass:"mt-3",attrs:{span:6}},[o("el-col",{attrs:{span:24}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Subtotal: ")])]),t._v(" "+t._s(t._f("valueFilterNull")(t.orderInfo.TotalAmount))+" VNĐ ")])]),o("el-col",{attrs:{span:24}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Discount: ")])]),t._v(" "+t._s(t._f("valueFilterNull")(t.orderInfo.Discount))+" VNĐ ")])]),o("el-col",{attrs:{span:24}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Shipping fee: ")])]),t._v(" "+t._s(t.orderInfo.CustomerOrderInfo.ShippingFee)+" VNĐ ")])]),o("el-col",{attrs:{span:24}},[o("span",[o("label",{staticClass:"mr-2",staticStyle:{"font-size":"18px"}},[o("b",[t._v(" Total: ")])]),t._v(" "+t._s(t._f("valueFilterNull")(t.orderInfo.FinalAmount))+" VNĐ ")])])],1)],1):t._e()],1)],1):t._e(),t.voucherInfo.voucherId==t.$ENV.GUID.EMPTY?o("el-row",[o("center",[o("h3",[t._v("Voucher is not exist")]),o("img",{attrs:{src:"https://firebasestorage.googleapis.com/v0/b/promotion-engine-3a6dc.appspot.com/o/error.png?alt=media&token=e1f1bfaa-b6f1-474a-8685-b366e5d9113e",alt:"Not found",width:"100"}})])],1):t._e()],1)],1)},a=[],n=o("2b0e"),r=o("4eb5"),s=o.n(r),l=o("c1df"),c=o.n(l);n["default"].use(s.a);var u={name:"check-voucher-info",props:{},data:function(){return{loading:!1}},computed:{voucherInfo:function(){return this.$store.state.voucher.checkVoucherInfo.voucherInfo},orderInfo:function(){return this.$store.state.voucher.checkVoucherInfo.order}},methods:{},filters:{valueFilterNull:function(t){return t||"N/A"},formatDate:function(t){return null==t?"N/A":c()(t).format("DD/MM/YYYY")},formatDateTime:function(t){return null==t?"N/A":c()(t).format("DD/MM/YYYY HH:mm")}}},d=u,m=(o("34ad"),o("2877")),p=Object(m["a"])(d,i,a,!1,null,"5efa12f2",null);e["a"]=p.exports},"48e7":function(t,e,o){"use strict";o("144e")},"4a11":function(t,e,o){},"4eb5":function(t,e,o){var i=o("6981"),a={autoSetContainer:!1,appendToBody:!0},n={install:function(t){t.prototype.$clipboardConfig=a,t.prototype.$copyText=function(t,e){return new Promise((function(o,n){var r=document.createElement("button"),s=new i(r,{text:function(){return t},action:function(){return"copy"},container:"object"===typeof e?e:document.body});s.on("success",(function(t){s.destroy(),o(t)})),s.on("error",(function(t){s.destroy(),n(t)})),a.appendToBody&&document.body.appendChild(r),r.click(),a.appendToBody&&document.body.removeChild(r)}))},t.directive("clipboard",{bind:function(t,e,o){if("success"===e.arg)t._vClipboard_success=e.value;else if("error"===e.arg)t._vClipboard_error=e.value;else{var n=new i(t,{text:function(){return e.value},action:function(){return"cut"===e.arg?"cut":"copy"},container:a.autoSetContainer?t:void 0});n.on("success",(function(e){var o=t._vClipboard_success;o&&o(e)})),n.on("error",(function(e){var o=t._vClipboard_error;o&&o(e)})),t._vClipboard=n}},update:function(t,e){"success"===e.arg?t._vClipboard_success=e.value:"error"===e.arg?t._vClipboard_error=e.value:(t._vClipboard.text=function(){return e.value},t._vClipboard.action=function(){return"cut"===e.arg?"cut":"copy"})},unbind:function(t,e){"success"===e.arg?delete t._vClipboard_success:"error"===e.arg?delete t._vClipboard_error:(t._vClipboard.destroy(),delete t._vClipboard)}})},config:a};t.exports=n},"512b":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("base-header",{class:t.headerClass,staticStyle:{"z-index":"-1"},style:t.headerStyle}),o("div",{staticClass:"container-fluid mt--6 mb-2",staticStyle:{"z-index":"100"}},[o("promotion-info",{ref:"promotionInfo",attrs:{promotionTiers:t.promotionTier,promotionParam:t.promotionDetail,paymentVariable:t.paymentVariable},on:{loadingStatus:t.loadingStatus}}),o("div",[o("el-card",{staticClass:"mt-3"},[o("h2",[t._v("DETAIL INFORMATION")]),o("el-tabs",{attrs:{type:"border-card"}},[o("el-tab-pane",{key:"Configure",attrs:{label:"Configure"}},[o("promotion-configure",{ref:"promotionConfig",attrs:{promotionParam:t.promotionDetail,paymentVariable:t.paymentVariable},on:{loadingStatus:t.loadingStatus,getPromotionDetail:t.getPromotionDetail}})],1),o("el-tab-pane",{key:"Tiers",attrs:{label:"Tiers"}},[o("promotion-action",{ref:"promotionAction",attrs:{promotionTierParam:t.promotionTier,promotionId:t.promotionDetail.promotionId,promotionDetail:t.promotionDetail},on:{loadingStatus:t.loadingStatus,getPromotionDetail:t.getPromotionDetail}})],1),o("el-tab-pane",{key:"Distribution",attrs:{label:"Distribution"}},[o("promotion-channel",{ref:"promotionChannel",attrs:{promotionDetail:t.promotionDetail,voucherGroupParam:t.voucherGroup},on:{loadingStatus:t.loadingStatus}})],1),o("el-tab-pane",{key:"Usage",attrs:{label:"Usage"}},[o("promotion-store",{ref:"promotionStore",attrs:{promotionDetail:t.promotionDetail,voucherGroupParam:t.voucherGroup},on:{loadingStatus:t.loadingStatus}})],1),o("el-tab-pane",{key:"Transaction",attrs:{label:"Transaction"}},[o("promotion-trans")],1)],1)],1)],1)],1)],1)},a=[],n=(o("96cf"),o("1da1")),r=o("2b0e"),s=o("4eb5"),l=o.n(s),c=o("5f5b"),u=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"font-size":"17px"}},[o("el-card",{staticClass:"custom-card",attrs:{shadow:"never"}},[o("el-row",{staticClass:"mb-3"},[o("el-col",{attrs:{span:12}},[o("h2",[t._v("GENERAL INFORMATION")])]),o("el-col",{attrs:{span:12}},[o("span",{staticClass:"float-right"},[o("label",{staticStyle:{"font-size":"0.95vw"}},[t._v("Last update: "),o("b",[t._v(t._s(t._f("formatDate")(t.promotion.updDate)))])]),o("span",[o("el-divider",{attrs:{direction:"vertical"}}),t.isEditInfo?t._e():o("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:t.editMode}},[t._v("Edit")]),t.isEditInfo?o("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.editMode}},[t._v("Cancel")]):t._e(),t.isEditInfo?o("el-button",{attrs:{size:"mini",icon:"el-icon-document",type:"primary"},on:{click:t.updateInfo}},[t._v("Save")]):t._e()],1)])]),o("el-col",{attrs:{span:24}},[o("el-divider",{staticClass:"mt-1 mb-1"})],1)],1),t.isEditInfo?t._e():o("el-row",[o("el-col",{attrs:{span:16}},[o("label",[o("b",[t._v(" Name ")]),t._v(t._s(t.promotion.promotionName)+" ")])]),o("el-col",{attrs:{span:8}},[o("el-col",{attrs:{span:12}},[o("span",[o("label",{staticClass:"mr-2"},[o("b",[t._v(" PUBLISH ")])]),o("el-switch",{attrs:{disabled:t.expiredBlock||t.tierBlock},on:{change:t.changeToggle},model:{value:t.statusToggle,callback:function(e){t.statusToggle=e},expression:"statusToggle"}})],1)]),o("el-col",{attrs:{span:12}})],1),o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("el-col",{attrs:{span:8}},[o("i",{staticClass:"el-icon-time mr-2"}),o("label",[o("b",[t._v("Start ")]),t._v(t._s(t._f("formatDate")(t.promotion.startDate))+" ")])]),o("el-col",{attrs:{span:8}},[o("label",[o("b",[t._v("Status ")]),t.promotion.status==t.$ENV.PROMOTION_STATUS.DRAFT?o("el-tag",{attrs:{effect:"dark",type:"info"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e(),t.promotion.status==t.$ENV.PROMOTION_STATUS.PUBLISH||t.promotion.status==t.$ENV.PROMOTION_STATUS.UNPUBLISH?o("el-tag",{attrs:{effect:"dark",type:"success"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e(),t.promotion.status==t.$ENV.PROMOTION_STATUS.EXPIRED?o("el-tag",{attrs:{effect:"dark",type:"danger"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e()],1)]),o("el-col",{attrs:{span:8}},[o("el-button",{attrs:{disabled:t.expiredBlock,type:"danger",plain:"",size:"medium",icon:"el-icon-check"},on:{click:t.expirePromo}},[t._v(" EXPIRE")])],1)],1),o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("el-col",{attrs:{span:8}},[o("i",{staticClass:"el-icon-time mr-2"}),o("label",[o("b",[t._v(" End ")]),t._v(t._s(t._f("formatDate")(t.promotion.endDate))+" ")])]),o("el-col",{attrs:{span:8}},[t.promotion.isAuto?t._e():o("label",[o("b",[t._v("Promo Code ")]),o("el-tag",{staticStyle:{"font-size":"16px"},attrs:{effect:"dark",type:"warning text-white"}},[o("b",[t._v(" "+t._s(t.promotion.promotionCode))])])],1)]),o("el-col",{attrs:{span:8}},[t.promotion.isAuto?o("el-tag",{attrs:{effect:"dark",type:"warning"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Automatic promotion")])]):t._e(),t.promotion.hasVoucher?o("el-tag",{attrs:{type:"success",effect:"dark"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Promotion using voucher code")])]):t._e(),t.promotion.hasVoucher||t.promotion.isAuto?t._e():o("el-tag",{attrs:{effect:"dark"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Promotion using promo code")])])],1)],1)],1),!t.isEditInfo||t.publishBlock||t.expiredBlock?t._e():o("el-form",{ref:"generalInfo",attrs:{rules:t.generalRule,model:t.promotion,"label-width":"5.5vw","label-position":"left"}},[o("el-row",{staticClass:"mt-3"},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Name",prop:"promotionName"}},[o("el-input",{attrs:{type:"text",maxlength:100,readonly:!t.isEditInfo,placeholder:"Please input"},model:{value:t.promotion.promotionName,callback:function(e){t.$set(t.promotion,"promotionName",e)},expression:"promotion.promotionName"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"Start date",prop:"startDate"}},[o("el-date-picker",{staticClass:"custom-datepicker",attrs:{readonly:!t.isEditInfo,format:"dd-MM-yyyy",type:"date",placeholder:"Pick a date","picker-options":t.pickerOptionsStartDate,clearable:!1},on:{change:t.changeStartDate},model:{value:t.promotion.startDate,callback:function(e){t.$set(t.promotion,"startDate",e)},expression:"promotion.startDate"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-form-item",[o("el-time-picker",{attrs:{readonly:!t.isEditInfo,placeholder:"Pick a time",clearable:!1,format:"HH:mm"},on:{change:t.changeStartDate},model:{value:t.promotion.startDate,callback:function(e){t.$set(t.promotion,"startDate",e)},expression:"promotion.startDate"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"End date"}},[void 0!==t.promotion?o("el-date-picker",{attrs:{readonly:!t.isEditInfo,format:"dd-MM-yyyy",type:"date",placeholder:"Pick a date","picker-options":t.pickerOptionEndDate,clearable:!1,disabled:t.isUnlimited},model:{value:t.promotion.endDate,callback:function(e){t.$set(t.promotion,"endDate",e)},expression:"promotion.endDate"}}):t._e()],1)],1),o("el-col",{attrs:{span:8}},[o("el-form-item",[void 0!==t.promotion?o("el-time-picker",{attrs:{readonly:!t.isEditInfo,placeholder:"Pick a time",format:"HH:mm",clearable:!1,disabled:t.isUnlimited,"default-value":null!=t.promotion.startDate&&""!=t.promotion.startDate?t.promotion.startDate+1:new Date},model:{value:t.promotion.endDate,callback:function(e){t.$set(t.promotion,"endDate",e)},expression:"promotion.endDate"}}):t._e()],1)],1),o("el-col",{attrs:{span:8}},[o("el-checkbox",{attrs:{disabled:!t.isEditInfo,id:"startDateCheckBox"},on:{change:t.unlimitHandle},model:{value:t.isUnlimited,callback:function(e){t.isUnlimited=e},expression:"isUnlimited"}},[t._v(" Unlimited ")])],1)],1)],1),t.isEditInfo&&(t.publishBlock||t.expiredBlock)?o("el-form",{ref:"generalInfo",attrs:{rules:t.generalRule,model:t.promotion,"label-width":"5.5vw","label-position":"left"}},[o("el-row",{staticClass:"mt-3"},[o("el-col",{attrs:{span:16}},[o("label",[o("b",[t._v(" Name ")]),t._v(t._s(t.promotion.promotionName)+" ")])])],1),o("el-row",{staticClass:"mt-3"},[o("el-col",{attrs:{span:8}},[o("i",{staticClass:"el-icon-time mr-2"}),o("label",[o("b",[t._v("Start ")]),t._v(t._s(t._f("formatDate")(t.promotion.startDate))+" ")])]),o("el-col",{attrs:{span:6}},[o("label",[o("b",[t._v("Status ")]),t.promotion.status==t.$ENV.PROMOTION_STATUS.DRAFT?o("el-tag",{attrs:{effect:"dark",type:"info"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e(),t.promotion.status==t.$ENV.PROMOTION_STATUS.PUBLISH||t.promotion.status==t.$ENV.PROMOTION_STATUS.UNPUBLISH?o("el-tag",{attrs:{effect:"dark",type:"success"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e(),t.promotion.status==t.$ENV.PROMOTION_STATUS.EXPIRED?o("el-tag",{attrs:{effect:"dark",type:"danger"}},[o("b",[t._v(" "+t._s(t._f("statusFilter")(t.promotion.status))+" ")])]):t._e()],1)]),o("el-col",{attrs:{span:10}},[t.promotion.isAuto?o("el-tag",{attrs:{effect:"dark",type:"warning"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Automatic promotion")])]):t._e(),t.promotion.hasVoucher?o("el-tag",{attrs:{type:"success",effect:"dark"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Promotion using voucher code")])]):t._e(),t.promotion.hasVoucher||t.promotion.isAuto?t._e():o("el-tag",{attrs:{effect:"dark"}},[o("p",{staticStyle:{"font-size":"1.1rem"}},[t._v("Promotion using promo code")])])],1)],1),o("el-row",{staticClass:"mt-3"},[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"End date"}},[void 0!==t.promotion?o("el-date-picker",{attrs:{readonly:!t.isEditInfo,format:"dd-MM-yyyy",type:"date",placeholder:"Pick a date","picker-options":t.pickerOptionEndDate,clearable:!1,disabled:t.isUnlimited},model:{value:t.promotion.endDate,callback:function(e){t.$set(t.promotion,"endDate",e)},expression:"promotion.endDate"}}):t._e()],1)],1),o("el-col",{attrs:{span:8}},[o("el-form-item",[void 0!==t.promotion?o("el-time-picker",{attrs:{readonly:!t.isEditInfo,placeholder:"Pick a time",format:"HH:mm",clearable:!1,disabled:t.isUnlimited,"default-value":null!=t.promotion.startDate&&""!=t.promotion.startDate?t.promotion.startDate+1:new Date},model:{value:t.promotion.endDate,callback:function(e){t.$set(t.promotion,"endDate",e)},expression:"promotion.endDate"}}):t._e()],1)],1),o("el-col",{attrs:{span:8}},[o("el-checkbox",{attrs:{disabled:!t.isEditInfo,id:"startDateCheckBox"},on:{change:t.unlimitHandle},model:{value:t.isUnlimited,callback:function(e){t.isUnlimited=e},expression:"isUnlimited"}},[t._v(" Unlimited ")])],1)],1)],1):t._e()],1)],1)},d=[],m=(o("4160"),o("159b"),o("c1df")),p=o.n(m);r["default"].use(l.a);var h={name:"promotion-info",directives:{"b-tooltip":c["b"]},computed:{publishBlock:function(){var t=this.promotionParam.status;return t==this.$ENV.PROMOTION_STATUS.PUBLISH||t==this.$ENV.PROMOTION_STATUS.UNPUBLISH},tierBlock:function(){var t=!this.promotionTiers||0==this.promotionTiers.length;return t},expiredBlock:function(){var t=this.promotionParam.status;return"4"==t},promotion:function(){return this.promotionParam},isUnlimitedDate:function(){return null==this.promotion.endDate},promotionStatus:function(){return this.promotionParam.status}},props:{promotionParam:Object,paymentVariable:Object,promotionTiers:Array},components:{},data:function(){return{pickerOptionEndDate:{disabledDate:this.handleDueDate},pickerOptionsStartDate:{disabledDate:function(t){return t.getTime()<=(new Date).getTime()}},generalRule:{startDate:[{required:!0,message:"Please select start date",trigger:["blur","change"]}],promotionName:[{required:!0,message:"Please input name",trigger:["blur","change"]}]},loading:!1,isUnlimited:!1,isEditInfo:!1,oldData:{},startTimeRange:NaN,endTimeRange:NaN,statusToggle:!1}},watch:{isUnlimitedDate:function(){this.isUnlimited=this.isUnlimitedDate},promotionStatus:function(){this.statusToggle=this.promotion.status==this.$ENV.PROMOTION_STATUS.PUBLISH}},created:function(){this.isUnlimited=this.isUnlimitedDate},mounted:function(){},methods:{handleDueDate:function(t){var e=new Date(this.promotion.startDate);return!(t.getTime()>e.getTime())},changeStartDate:function(){this.isUnlimited||(""!=this.promotion.endDate?this.promotion.endDate.getTime()<=this.promotion.startDate.getTime()&&(this.promotion.endDate=new Date(this.promotion.startDate.getTime()+864e5)):this.promotion.endDate=new Date(this.promotion.startDate.getTime()+864e5))},expirePromo:function(){var t=this;this.$confirm("Do you want to expire promotion. After expired, you cannot publish it again. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){t.updateStatus(t.$ENV.PROMOTION_STATUS.EXPIRED)}))},changeToggle:function(t){var e=this;this.promotion.status==this.$ENV.PROMOTION_STATUS.DRAFT?this.$confirm("After publishing promotion, you can only update end date. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){t?e.updateStatus(e.$ENV.PROMOTION_STATUS.PUBLISH):e.updateStatus(e.$ENV.PROMOTION_STATUS.UNPUBLISH)})).catch((function(){e.statusToggle=!1})):t?this.updateStatus(this.$ENV.PROMOTION_STATUS.PUBLISH):this.updateStatus(this.$ENV.PROMOTION_STATUS.UNPUBLISH)},unlimitHandle:function(t){this.promotion.endDate=t?null:new Date(new Date(this.promotion.startDate).getTime()+864e5)},updateInfo:function(){var t=this;this.$refs["generalInfo"].validate((function(e){if(e){t.loading=!0,t.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var o={promotionId:"",promotionName:t.promotion.promotionName,startDate:t.promotion.startDate.toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),endDate:null!=t.promotion.endDate?t.promotion.endDate.toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}):t.promotion.endDate,updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),isAuto:t.promotion.isAuto,hasVoucher:t.promotion.hasVoucher,exlusive:-1};t.$store.commit("promotion_detail/setPromotionDetailUpdate",o),t.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(){t.loading=!1,t.oldData={},t.isEditInfo=!t.isEditInfo,t.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),t.$message({message:"Update successful",type:"success"})})).catch((function(e){t.loading=!1,t.editMode(),t.$message({message:e.message+", please try again.",type:"error"})}))}}))},editMode:function(){this.isEditInfo=!this.isEditInfo,this.isEditInfo?this.oldData={promotionName:this.promotion.promotionName,startDate:this.promotion.startDate,endDate:this.promotion.endDate}:(this.promotion.promotionName=this.oldData.promotionName,this.promotion.startDate=this.oldData.startDate,this.promotion.endDate=this.oldData.endDate,this.isUnlimited=null==this.promotion.endDate,this.oldData={},this.reloadWhenCancel())},reloadWhenCancel:function(){var t=this;this.loading=!0,this.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var e={promotionId:"",promotionName:this.promotion.promotionName,startDate:this.promotion.startDate.toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),endDate:null!=this.promotion.endDate?this.promotion.endDate.toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}):this.promotion.endDate,updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),isAuto:this.promotion.isAuto,hasVoucher:this.promotion.hasVoucher,exlusive:-1};this.$store.commit("promotion_detail/setPromotionDetailUpdate",e),this.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(){t.loading=!1,t.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"})})).catch((function(){t.loading=!1}))},deletePromotion:function(){var t=this;this.$confirm("Do you want to delete promotion ?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){t.$message({type:"success",message:"Delete completed"})}))},handleMemberLevelBeforeUpdate:function(t){var e=t.memberLevelMapping,o=t.promotionId;if(console.log("promo id",o),e&&e.length>0){var i=[];e.forEach((function(t){var e={memberLevelId:t,promotionId:o};i.push(e)})),t.memberLevelMapping=i}return t.promotionStoreMapping=null,t},updateStatus:function(t){var e=this,o=this.promotion.status;this.loading=!0,this.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var i=this.promotion;i.status=t,i=this.handleMemberLevelBeforeUpdate(i),this.$store.commit("promotion_detail/setPromotionDetailUpdate",i),this.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(){e.loading=!1,e.$message({message:"Update successful",type:"success"}),e.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),e.$store.commit("promotion_detail/setStatus",t)})).catch((function(t){e.promotion.status=o,e.$store.commit("promotion_detail/setStatus",o),e.loading=!1,e.statusToggle=!e.statusToggle,e.$message({message:t.message+", please try again.",type:"error"})}))}},filters:{discountTypeFilter:function(t){switch(t){case"1":return"Discount amount (VNĐ)";case"2":return"Discount percentage (%)";case"3":return"Discount unit";case"4":return"Discount shipping fee";case"5":return"Fixed price";case"6":return"Ladder price";case"7":return"Bundle price";case"8":return"Gift product";case"9":return"Gift voucher"}},statusFilter:function(t){switch(t){case 1:return"DRAFT";case 2:return"PUBLISH";case 3:return"UNPUBLISH";case 4:return"EXPIRED"}},formatDate:function(t){return null!=t?p()(t).format("DD/MM/YYYY HH:mm"):"Unlimit"},promotionTypeName:function(t){switch(t){case"1":return"Discount";case"2":return"Automatically";case"3":return"Gift";case"4":return"Bonus point"}return t}}},f=h,g=(o("3b23"),o("2877")),v=Object(g["a"])(f,u,d,!1,null,null,null),b=v.exports,y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("div",{staticClass:"card-body"},[o("el-row",{attrs:{type:"flex",justify:"end"}},[o("el-col",{attrs:{span:24}},[o("h2",[t._v("PROMOTION TIER")])])],1),t.promotionTiers?o("el-row",{staticClass:"mt-2"},[o("el-col",{attrs:{span:24}},[o("label",{staticClass:"custom-tag"},[o("i",{staticClass:"el-icon-warning-outline mr-1"}),t._v(" Promotion has "),o("b",[t._v(t._s(t.promotionTiers.length))]),t._v(" tier(s) ")])]),o("el-col",{attrs:{span:10}},[t.actionType!=t.$ENV.ACTION_TYPE.EMPTY?o("label",{staticClass:"mt-2",staticStyle:{color:"black","font-size":"20x"}},[o("b",[t._v(" Action Type: ")]),t._v(" "+t._s(t._f("actionTypeFilter")(t.promotionDetailParam.actionType))+" ")]):t._e(),t.postActionType!=t.$ENV.POST_ACTION_TYPE.EMPTY?o("label",{staticClass:"mt-2",staticStyle:{color:"black","font-size":"20x"}},[o("b",[t._v(" Gift Type: ")]),t._v(" "+t._s(t._f("postActionTypeFilter")(t.promotionDetailParam.postActionType))+" ")]):t._e()]),o("el-col",{attrs:{span:14}},[o("span",{staticClass:"float-right"},[o("el-button",{staticClass:"float-right",attrs:{disabled:t.publishBlock||t.expiredBlock,icon:"el-icon-plus",type:"success"},on:{click:t.openDialog}},[t._v("New Promotion Tier")])],1)])],1):t._e(),t.promotionTiers&&0!=t.promotionTiers.length?t._e():o("el-card",{staticClass:"mb-4 mt-3 custom-card-2",attrs:{shadow:"never"}},[o("center",[o("label",{staticStyle:{color:"grey"}},[t._v("No data")])])],1),t._l(t.promotionTiers,(function(e,i){return o("el-card",{key:e.id,staticClass:"mb-4 mt-3 custom-card-2",attrs:{shadow:"never"}},[t.promotionTiers&&t.promotionTiers.length>0?o("el-row",[o("el-row",[o("el-col",{attrs:{span:8}},[o("h3",[t._v("PROMOTION TIER "+t._s(i+1))])]),o("el-col",{attrs:{span:11}},[o("label",{staticClass:"float-right"},[o("b",[t._v(" Priority: ")]),t._v(" "+t._s(e.priority)+" ")])]),t.publishBlock||t.expiredBlock?t._e():o("el-col",{attrs:{span:5}},[o("el-button",{staticClass:"float-right",attrs:{type:"info",size:"mini",icon:"el-icon-close",plain:""},on:{click:function(o){return t.deletePromotionTier(e)}}})],1)],1),o("el-col",{attrs:{span:24}},[o("el-divider",{staticClass:"mt-2 mb-3"})],1),o("el-row",{staticClass:"ml-3"},[t.promotionDetail.hasVoucher?o("el-col",{staticClass:"vertical-split",attrs:{span:8}},[o("h3",[t._v(" VOUCHER GROUP "),e.action&&e.action.delFlg||e.gift&&e.gift.delFlg?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),o("router-link",{staticStyle:{"word-break":"break-word"},attrs:{type:"primary",to:{name:"Voucher Group Detail",params:{id:e.voucherGroup.voucherGroupId}}}},[t._v(" "+t._s(e.voucherGroup.voucherName)+" ")])],1):t._e(),null!=e.conditionRule?o("el-col",{staticClass:"vertical-split",attrs:{span:8}},[o("h3",[t._v(" CONDITION "),e.conditionRule&&e.conditionRule.delFlg?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),e.conditionRule&&!e.conditionRule.delFlg?o("router-link",{staticStyle:{"word-break":"break-word"},attrs:{type:"primary",to:{name:"Condition Detail",params:{id:e.conditionRule.conditionRuleId}}}},[t._v(" "+t._s(e.conditionRule.ruleName)+" ")]):t._e(),e.conditionRule&&e.conditionRule.delFlg?o("div",[o("p",[t._v(t._s(e.conditionRule.ruleName))])]):t._e()],1):t._e(),t.actionType>t.$ENV.ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:8}},[o("h3",[t._v(" ACTION "),e.action&&e.action.delFlg?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),e.action&&!e.action.delFlg?o("el-button",{staticClass:"m-0 p-0 text-blue",staticStyle:{"font-size":"1rem"},attrs:{type:"text"},on:{click:function(o){return t.openActionDetail(e.actionId)}}},[t._v(" "+t._s(e.action.name))]):t._e(),e.action&&e.action.delFlg?o("div",[o("p",[t._v(t._s(e.action.name))])]):t._e()],1):t._e(),t.postActionType>t.$ENV.POST_ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:8}},[o("h3",[t._v(" GIFT "),e.gift&&e.gift.delFlg?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),o("p",[t._v(" "+t._s(e.gift.name)+" ")])]):t._e()],1)],1):t._e(),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-button",{staticClass:"float-right p-0 m-0",staticStyle:{outline:"0px",border:"0px"},attrs:{type:"text",size:"medium"},on:{click:function(o){return t.viewCondUpd(e)}}},[t._v("View detail")])],1)],1),o("el-row",[o("el-divider",{staticClass:"mt-1 mb-2"}),e.conditionRule&&e.conditionRule.delFlg?o("el-tag",{staticStyle:{"font-size":"0.95rem"},attrs:{type:"danger"}},[o("i",{staticClass:"el-icon-warning-outline"}),t._v(" Condition has been deleted. Please select another condition ")]):t._e(),o("br"),e.action&&e.action.delFlg?o("el-tag",{staticClass:"mt-1",staticStyle:{"font-size":"0.95rem"},attrs:{type:"danger"}},[o("i",{staticClass:"el-icon-warning-outline"}),t._v(" Action has been deleted. Please select another action ")]):t._e(),o("br"),e.gift&&e.gift.delFlg?o("el-tag",{staticClass:"mt-1",staticStyle:{"font-size":"0.95rem"},attrs:{type:"danger"}},[o("i",{staticClass:"el-icon-warning-outline"}),t._v(" Action has been deleted. Please select another action ")]):t._e()],1)],1)}))],2),o("el-dialog",{attrs:{id:"upd-condition",title:"UPDATE PROMOTION TIER",visible:t.updCondDiaglog,width:"80vw","before-close":t.updateDialogClose,"close-on-click-modal":!1,"append-to-body":!0},on:{"update:visible":function(e){t.updCondDiaglog=e}}},[o("update-tier",{ref:"updateTier",attrs:{postActionType:t.promotionDetailParam.postActionType,actionType:t.promotionDetailParam.actionType,tierIndex:t.promotionTiers.length},on:{closeDialog:t.updateDialogClose,getPromotionDetail:t.getPromotionDetail,viewCondUpd:t.viewCondUpd}})],1),o("el-dialog",{attrs:{"custom-class":"my-custom-dialog",title:"CREATE PROMOTION TIER","close-on-click-modal":!1,"append-to-body":!0,visible:t.dialogVisible,"before-close":t.createDialogClose,width:"80vw"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("create-tier",{ref:"createTier",attrs:{promotionDetail:t.promotionDetailParam,postActionType:t.promotionDetailParam.postActionType,actionType:t.promotionDetailParam.actionType,tierIndex:t.promotionTiers.length},on:{closeDialog:t.createDialogClose}})],1),o("el-dialog",{attrs:{title:"UPDATE ACTION",width:"55%",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("action-detail",{ref:"actionDetailDialog"})],1)],1)},_=[],C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"create-tier"}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("el-form",{ref:"createTierForm",attrs:{model:t.promotionTier,rules:t.rule}},[o("el-card",[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:t.promotionDetail.hasVoucher?12:24}},[o("el-row",{attrs:{gutter:10}},[o("el-card",{staticClass:"pb-3",attrs:{shadow:"never"}},[o("h2",[t._v("TIER SETTING")]),o("el-divider",{staticClass:"mt-2 mb-4"}),o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?11:8}},[o("h3",[t._v("Condition")]),o("el-form-item",{attrs:{prop:"conditionRuleId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.conditionLoading,expression:"conditionLoading"}],staticStyle:{width:"90%"},model:{value:t.promotionTier.conditionRuleId,callback:function(e){t.$set(t.promotionTier,"conditionRuleId",e)},expression:"promotionTier.conditionRuleId"}},t._l(t.conditions,(function(t,e){return o("el-option",{key:e,attrs:{label:t.ruleName,value:t.conditionRuleId}})})),1)],1)],1),t.promotionDetail.actionType>t.$ENV.ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?11:8}},[o("h3",[t._v("Discount action")]),t.promotionDetail.hasVoucher?o("p",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(t.actionName)+" ")]):t._e(),t.promotionDetail.hasVoucher?t._e():o("el-form-item",{attrs:{prop:"actionId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.actionLoading,expression:"actionLoading"}],staticStyle:{width:"90%"},model:{value:t.promotionTier.actionId,callback:function(e){t.$set(t.promotionTier,"actionId",e)},expression:"promotionTier.actionId"}},t._l(t.actions,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.actionId}})})),1)],1)],1):t._e(),t.promotionDetail.postActionType>t.$ENV.POST_ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?12:8}},[o("h3",[t._v("Gift action")]),t.promotionDetail.hasVoucher?o("p",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(t.giftName)+" ")]):t._e(),t.promotionDetail.hasVoucher?t._e():o("el-form-item",{attrs:{prop:"giftId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.giftLoading,expression:"giftLoading"}],staticStyle:{width:"90%"},model:{value:t.promotionTier.giftId,callback:function(e){t.$set(t.promotionTier,"giftId",e)},expression:"promotionTier.giftId"}},t._l(t.gifts,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.giftId}})})),1)],1)],1):t._e(),o("el-col",{class:t.promotionDetail.hasVoucher?"vertical-split mt-2":"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?24:8}},[o("h3",[t._v("Priority of tier")]),o("el-form-item",{attrs:{prop:"priority"}},[o("el-select",{style:t.promotionDetail.hasVoucher?"width: 40%":"width:80%",attrs:{placeholder:"Select priority"},model:{value:t.promotionTier.priority,callback:function(e){t.$set(t.promotionTier,"priority",e)},expression:"promotionTier.priority"}},t._l(t.numbers,(function(t,e){return o("el-option",{key:e,attrs:{label:t,value:t}})})),1)],1)],1)],1)],1)],1),o("el-col",{attrs:{span:12}},[t.promotionDetail.hasVoucher?o("el-row",{attrs:{gutter:20}},[o("el-card",{staticClass:"pb-4",attrs:{shadow:"never"}},[o("h2",[t._v("Voucher Configuration")]),o("el-divider",{staticClass:"mt-2 mb-4"}),o("el-col",{staticClass:"vertical-split",staticStyle:{"min-height":"22.5vh"},attrs:{span:12}},[o("h3",[t._v("Voucher Group")]),o("el-form-item",{attrs:{prop:"voucherGroupId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.voucherLoading,expression:"voucherLoading"}],attrs:{placeholder:"Select Voucher Group"},on:{change:t.changeSelectVoucher},model:{value:t.promotionTier.voucherGroupId,callback:function(e){t.$set(t.promotionTier,"voucherGroupId",e)},expression:"promotionTier.voucherGroupId"}},t._l(t.vouchers,(function(t,e){return o("el-option",{key:e,attrs:{label:t.voucherName,value:t.voucherGroupId}})})),1)],1),o("h3",[t._v("Quantity of voucher")]),o("el-form-item",{staticClass:"mb-0",attrs:{prop:"voucherQuantity"}},[o("el-input-number",{staticStyle:{width:"80%"},attrs:{size:"medium",min:t.minVoucherQuantity,max:t.maxVoucherQuantity},model:{value:t.promotionTier.voucherQuantity,callback:function(e){t.$set(t.promotionTier,"voucherQuantity",e)},expression:"promotionTier.voucherQuantity"}})],1)],1),o("el-col",{staticClass:"vertical-split",staticStyle:{"min-height":"22.5vh"},attrs:{span:12}},[o("h3",[t._v("Voucher information")]),o("p",[t._v("Name: "+t._s(t._f("voucherNameFilter")(t.selectedVoucher.voucherName)))]),o("p",[t._v(" Total: "+t._s(t._f("voucherNameFilter")(t.selectedVoucher.quantity))+" voucher(s) ")]),o("p",[t._v("Remain: "+t._s(t.maxVoucherQuantity)+" voucher(s)")])])],1)],1):t._e()],1)],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-button",{staticClass:"float-right mt-3",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.createTier}},[t._v("New Tier")])],1)],1)],1)],1)],1)])},w=[],T=(o("7db0"),o("45fc"),o("b0c0"),o("a9e3"),{name:"create-promotion-tier",created:function(){this.setupData()},watch:{minVoucherQuantity:function(){this.promotionTier.fromIndex=this.voucherIndexInfo.fromIndex,this.promotionTier.quantity=this.minVoucherQuantity}},beforeDestroy:function(){this.$store.commit("voucher/setIndexInfo",{}),this.$store.commit("voucher/setVoucherList",[]),this.$store.commit("voucher/setActions",[]),this.$store.commit("voucher/setPostActions",[]),this.$store.commit("voucher/setConditions",[]),this.$store.commit("promotion_detail/setTierUpdate",{})},computed:{voucherIndexInfo:function(){return this.$store.state.voucher.indexInfo},maxVoucherQuantity:function(){var t=this.voucherIndexInfo.remain;return t||0},minVoucherQuantity:function(){var t=this.voucherIndexInfo.remain;return t>0?1:0},vouchers:function(){return this.$store.state.voucher.voucherList.data},actions:function(){return this.$store.state.voucher.actions},gifts:function(){return this.$store.state.voucher.gifts},conditions:function(){return this.$store.state.voucher.conditions}},props:{actionType:Number,postActionType:Number,tierIndex:Number,promotionDetail:Object},filters:{voucherNameFilter:function(t){return t||"No data"}},data:function(){var t=this,e=function(e,o,i){""==t.promotionTier.conditionRuleId?i(new Error("Please select condition")):i()},o=function(e,o,i){""==t.promotionTier.actionId?i(new Error("Please select discount action")):i()},i=function(e,o,i){""==t.promotionTier.giftId?i(new Error("Please select gift action")):i()},a=function(e,o,i){""==t.promotionTier.giftId?i(new Error("Please select gift action")):i()},n=function(e,o,i){0==t.promotionTier.priority&&i(new Error("Please select priority")),t.promotionDetail.promotionTier.some((function(e){return e.priority==t.promotionTier.priority}))&&i(new Error("Priority is not the same between each tier")),i()},r=function(e,o,i){0==t.promotionTier.voucherQuantity?i(new Error("Please select priority")):i()};return{rule:{voucherQuantity:[{validator:r,trigger:["blur","change"],message:"Please input quantity"}],conditionRuleId:[{validator:e,trigger:["blur","change"],message:"Please select condition"}],priority:[{validator:n,trigger:["blur","change"]}],actionId:[{validator:o,trigger:["blur","change"],message:"Please select discount action"}],giftId:[{validator:i,trigger:["blur","change"],message:"Please select gift action"}],voucherGroupId:[{validator:a,trigger:["blur","change"],message:"Please select voucherd"}]},validateFields:["conditionRuleId","voucherGroupId","giftId","actionId","priority","conditionRuleId","voucherQuantity"],numbers:[],loading:!1,actionLoading:!1,conditionLoading:!1,giftLoading:!1,voucherLoading:!1,promotionTier:{promotionId:"",priority:0,voucherQuantity:0,tierIndex:0,voucherGroupId:"",conditionRuleId:"",actionId:"",giftId:""},selectedVoucher:{},giftName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,actionName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text}},methods:{clearData:function(){this.promotionTier={promotionId:"",tierIndex:0,priority:0,voucherQuantity:0,voucherGroupId:"",conditionRuleId:"",actionId:"",giftId:""},this.selectedVoucher={},this.giftName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.actionName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.$refs["createTierForm"].clearValidate(this.validateFields)},setupData:function(){this.numbers=[];for(var t=1;t<=100;t++)this.numbers.push(t);this.getVoucherGroups(),this.getConditions(),this.getActions(),this.getPostActions()},checkIndexInfo:function(t){var e=this;this.voucherLoading=!0,this.$store.commit("voucher/setCheckIndexId",t),this.$store.dispatch("voucher/getIndexInfo").then((function(t){if(200!=t.status)e.$notify({title:"Error",message:"Cannot get Voucher info",type:"danger"});else{var o=e.voucherIndexInfo;e.promotionTier.fromIndex=o.fromIndex}e.voucherLoading=!1})).catch((function(){e.voucherLoading=!1,e.$notify({title:"Error",message:"Cannot get Voucher info",type:"danger"})}))},changeSelectVoucher:function(t){var e=this.vouchers.find((function(e){return e.voucherGroupId==t}));e.gift&&(this.giftName=e.gift.name),e.action&&(this.actionName=e.action.name),this.selectedVoucher=e,this.promotionTier.actionId=e.actionId,this.promotionTier.giftId=e.giftId,this.checkIndexInfo(t)},getVoucherGroups:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.voucherLoading=!0,t.$store.commit("voucher/setActionType",t.actionType),t.$store.commit("voucher/setPostActionType",t.postActionType),t.$store.commit("voucher/setPageSize",0),t.$store.commit("voucher/setPageIndex",0),e.next=7,t.$store.dispatch("voucher/getVoucherList").then((function(e){t.voucherLoading=!1,t.$store.commit("voucher/setPageSize",10),t.$store.commit("voucher/setPageIndex",1),200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Voucher error !",type:"danger"})})).catch((function(){t.$store.commit("voucher/setPageSize",10),t.$store.commit("voucher/setPageIndex",1),t.voucherLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Voucher error !",type:"danger"})}));case 7:case"end":return e.stop()}}),e)})))()},createTier:function(){var t=this;this.$refs["createTierForm"].validate((function(e){if(e){t.loading=!0;var o=t.promotionTier.fromIndex,i=t.promotionTier.quantity,a=i-1+o;t.promotionTier.toIndex=a>0?a:0,t.promotionTier.tierIndex=t.tierIndex,t.promotionTier.promotionId=t.$route.params.id,t.$store.commit("promotion/setInsertTierParam",t.promotionTier),t.$store.dispatch("promotion/CreatePromotionTier").then((function(e){t.loading=!1,200==e.status?(t.$notify({icon:"el-icon-warning",title:"Success",message:"Create successful !",type:"success"}),t.$store.commit("voucher/setIndexInfo",{available:!1,remain:0,total:0}),t.$emit("closeDialog")):(t.loading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:" error !",type:"danger"}))})).catch((function(){t.$notify({icon:"el-icon-warning",title:"Error",message:" error !",type:"danger"})}))}}))},getConditions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.conditionLoading=!0,e.next=3,t.$store.dispatch("voucher/getConditions").then((function(e){t.conditionLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Condition error !",type:"danger"})})).catch((function(){t.conditionLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Condition error !",type:"danger"})}));case 3:case"end":return e.stop()}}),e)})))()},getPostActions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.giftLoading=!0,o=t.postActionType,t.$store.commit("voucher/setPostActionType",o),e.next=5,t.$store.dispatch("voucher/getPostAction").then((function(e){t.giftLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Gift error !",type:"danger"})})).catch((function(){t.giftLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Gift error !",type:"danger"})}));case 5:case"end":return e.stop()}}),e)})))()},getActions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.actionLoading=!0,o=t.actionType,t.$store.commit("voucher/setActionType",o),e.next=5,t.$store.dispatch("voucher/getAction").then((function(e){t.actionLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Action error !",type:"danger"})})).catch((function(){t.actionLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Action error !",type:"danger"})}));case 5:case"end":return e.stop()}}),e)})))()}}}),I=T,P=(o("16e4"),o("d603"),Object(g["a"])(I,C,w,!1,null,"7489ff94",null)),x=P.exports,D=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"m-0",attrs:{id:"update-tier"}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("el-form",{ref:"updateTierForm",attrs:{model:t.promotionTier,rules:t.rule}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:t.promotionDetail.hasVoucher?12:24}},[o("el-row",{attrs:{gutter:10}},[o("el-card",{staticClass:"pb-3",attrs:{shadow:"never"}},[o("h2",[t._v("TIER SETTING")]),o("el-divider",{staticClass:"mt-2 mb-4"}),o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?11:8}},[o("h3",[t._v(" Condition "),t.promotionTier.conditionRule.delFlg?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),t.publishBlock||t.promotionTier.conditionRule.delFlg?o("label",[t._v(" "+t._s(t.conditionName)+" ")]):t._e(),!t.publishBlock||t.promotionTier.conditionRule.delFlg?o("el-form-item",{attrs:{prop:"conditionId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.conditionLoading,expression:"conditionLoading"}],model:{value:t.promotionTier.conditionRuleId,callback:function(e){t.$set(t.promotionTier,"conditionRuleId",e)},expression:"promotionTier.conditionRuleId"}},t._l(t.conditions,(function(t,e){return o("el-option",{key:e,attrs:{label:t.ruleName,value:t.conditionRuleId}})})),1)],1):t._e()],1),t.promotionDetail.actionType>t.$ENV.ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?11:8}},[o("h3",[t._v(" Action "),t.dispIconAction?o("i",{staticClass:"el-icon-warning-outline text-danger"}):t._e()]),o("p",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(t.actionName)+" ")]),t.dispSelectAction?o("el-form-item",{attrs:{prop:"actionId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.actionLoading,expression:"actionLoading"}],model:{value:t.promotionTier.actionId,callback:function(e){t.$set(t.promotionTier,"actionId",e)},expression:"promotionTier.actionId"}},t._l(t.actions,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.actionId}})})),1)],1):t._e()],1):t._e(),t.promotionDetail.postActionType>t.$ENV.POST_ACTION_TYPE.EMPTY?o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?11:8}},[o("h3",[t._v("Action")]),o("p",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(t.giftName)+" ")]),t.dispSelectGift?o("el-form-item",{attrs:{prop:"giftId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.giftLoading,expression:"giftLoading"}],model:{value:t.promotionTier.giftId,callback:function(e){t.$set(t.promotionTier,"giftId",e)},expression:"promotionTier.giftId"}},t._l(t.gifts,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.giftId}})})),1)],1):t._e()],1):t._e(),o("el-col",{staticClass:"vertical-split",attrs:{span:t.promotionDetail.hasVoucher?24:8}},[o("h3",[t._v("Priority")]),o("el-form-item",{attrs:{prop:"priority"}},[o("el-select",{attrs:{placeholder:"Select priority"},model:{value:t.promotionTier.priority,callback:function(e){t.$set(t.promotionTier,"priority",e)},expression:"promotionTier.priority"}},t._l(t.numbers,(function(t,e){return o("el-option",{key:e,attrs:{label:t,value:t}})})),1)],1)],1)],1)],1)],1),t.promotionDetail.hasVoucher?o("el-col",{attrs:{span:12}},[o("el-row",{attrs:{gutter:20}},[o("el-card",{class:t.promotionDetail.hasVoucher?"pb-3 ":"",attrs:{shadow:"never"}},[o("h2",[t._v("Voucher Configuration")]),o("el-divider",{staticClass:"mt-2 mb-4"}),o("el-col",{staticClass:"vertical-split",staticStyle:{"min-height":"23vh"},attrs:{span:12}},[o("h3",[t._v("Voucher Group")]),o("el-form-item",{attrs:{prop:"voucherGroupId"}},[t.publishBlock?t._e():o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.voucherLoading,expression:"voucherLoading"}],attrs:{disabled:!t.promotionDetail.hasVoucher,placeholder:"Select Voucher Group"},on:{change:t.changeSelectVoucher},model:{value:t.promotionTier.voucherGroupId,callback:function(e){t.$set(t.promotionTier,"voucherGroupId",e)},expression:"promotionTier.voucherGroupId"}},t._l(t.vouchers,(function(t,e){return o("el-option",{key:e,attrs:{label:t.voucherName,value:t.voucherGroupId}})})),1)],1),t.publishBlock?o("label",[t._v(" "+t._s(t.conditionName)+" ")]):t._e(),t.isChangeNewVoucher?o("div",{staticClass:"mt-3"},[o("h3",[t._v("Quantity of voucher")]),o("el-form-item",{attrs:{prop:"voucherQuantity"}},[o("el-input-number",{attrs:{disabled:!t.promotionDetail.hasVoucher,max:t.maxVoucherQuantity,min:t.minVoucherQuantity},model:{value:t.newQuantity,callback:function(e){t.newQuantity=e},expression:"newQuantity"}})],1)],1):t._e(),t.isChangeNewVoucher?t._e():o("div",{staticClass:"mt-3"},[o("h3",[t._v("Add more voucher for tier")]),o("el-input-number",{staticClass:"mb-0",attrs:{disabled:!t.promotionDetail.hasVoucher,max:t.maxVoucherQuantity,min:t.minVoucherQuantity},model:{value:t.moreQuantity,callback:function(e){t.moreQuantity=e},expression:"moreQuantity"}})],1)],1),o("el-col",{staticClass:"vertical-split",staticStyle:{"min-height":"23vh"},attrs:{span:12}},[o("h3",[t._v("Voucher information")]),o("p",[t._v("Name: "+t._s(t._f("voucherNameFilter")(t.selectedVoucher.voucherName)))]),o("p",[t._v(" Total: "+t._s(t._f("voucherNameFilter")(t.selectedVoucher.quantity))+" voucher(s) ")]),o("p",[t._v("Remain: "+t._s(t.maxVoucherQuantity)+" voucher(s)")]),t.isChangeNewVoucher?t._e():o("p",[t._v(" The tier has "+t._s(t.promotionTier.voucherQuantity)+" voucher(s) ")])])],1)],1)],1):t._e()],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-button",{staticClass:"float-right mt-3",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.updateTier}},[t._v("Update Tier")])],1)],1)],1)],1)])},E=[],S={name:"update-promotion-tier",created:function(){this.setupData()},filters:{voucherNameFilter:function(t){return t||"No data"}},watch:{minVoucherQuantity:function(){this.promotionTier.fromIndex=this.voucherIndexInfo.fromIndex,this.promotionTier.quantity=this.minVoucherQuantity}},beforeDestroy:function(){this.$store.commit("voucher/setIndexInfo",{}),this.$store.commit("voucher/setVoucherList",[]),this.$store.commit("voucher/setActions",[]),this.$store.commit("voucher/setPostActions",[]),this.$store.commit("voucher/setConditions",[]),this.$store.commit("promotion_detail/setTierUpdate",{})},computed:{publishBlock:function(){console.log("publish block");var t=this.$store.state.promotion_detail.promotionDetail,e=t.status;return e==this.$ENV.PROMOTION_STATUS.PUBLISH||e==this.$ENV.PROMOTION_STATUS.UNPUBLISH},dispIconAction:function(){return!!this.tierUpdate.action&&this.tierUpdate.action.delFlg},dispLabelAction:function(){return this.promotionDetail.hasVoucher,!0},dispSelectAction:function(){return!this.promotionDetail.hasVoucher&&(!!this.tierUpdate.action&&this.tierUpdate.action.delFlg)},dispSelectGift:function(){return!this.promotionDetail.hasVoucher&&(!!this.tierUpdate.gift&&this.tierUpdate.gift.delFlg)},promotionDetail:function(){return this.$store.state.promotion_detail.promotionDetail},voucherIndexInfo:function(){return this.$store.state.voucher.indexInfo},maxVoucherQuantity:function(){var t=this.voucherIndexInfo.remain;return t||0},minVoucherQuantity:function(){return 0},vouchers:function(){return this.$store.state.voucher.voucherList.data},actions:function(){return this.$store.state.voucher.actions},gifts:function(){return this.$store.state.voucher.gifts},conditions:function(){return this.$store.state.voucher.conditions},tierUpdate:function(){return this.$store.state.promotion_detail.tierUpdate}},props:{actionType:Number,postActionType:Number,tierIndex:Number},data:function(){var t=this,e=function(e,o,i){""==t.promotionTier.conditionRuleId?i(new Error("Please select condition")):i()},o=function(e,o,i){""==t.promotionTier.actionId?i(new Error("Please select discount action")):i()},i=function(e,o,i){""==t.promotionTier.giftId?i(new Error("Please select gift action")):i()},a=function(e,o,i){""==t.promotionTier.voucherGroupId?i(new Error("Please select voucher group")):i()},n=function(e,o,i){0==t.promotionTier.priority&&i(new Error("Please select priority")),t.promotionDetail.promotionTier.some((function(e){return e.priority==t.promotionTier.priority&&e.promotionTierId!=t.promotionTier.promotionTierId}))&&i(new Error("Priority is not the same between each tier")),i()},r=function(e,o,i){0==t.newQuantity?i(new Error("Please input quantity")):i()};return{rule:{voucherQuantity:[{validator:r,trigger:["blur","change"],message:"Please input quantity"}],conditionId:[{validator:e,trigger:["blur","change"],message:"Please select condition"}],priority:[{validator:n,trigger:["blur","change"]}],actionId:[{validator:o,trigger:["blur","change"],message:"Please select discount action"}],giftId:[{validator:i,trigger:["blur","change"],message:"Please select gift action"}],voucherGroupId:[{validator:a,trigger:["blur","change"],message:"Please select voucherd"}]},validateFields:["conditionRuleId","voucherGroupId","giftId","actionId","priority","conditionRuleId"],currentVoucherGroup:"",isChangeNewVoucher:!1,numbers:[],loading:!1,actionLoading:!1,conditionLoading:!1,giftLoading:!1,voucherLoading:!1,promotionTier:{promotionId:"",fromIndex:0,toIndex:0,quantity:0,tierIndex:0,voucherGroupId:"",conditionRuleId:"",actionId:"",conditionRule:{},giftId:""},newQuantity:0,moreQuantity:0,giftName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,actionName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,selectedVoucher:{},conditionName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,voucherGroupName:this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text}},methods:{clearData:function(){this.promotionTier={promotionId:"",fromIndex:0,toIndex:0,quantity:0,tierIndex:0,voucherGroupId:"",conditionRuleId:"",conditionRule:{},actionId:"",giftId:""},this.giftName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.actionName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.conditionName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.voucherGroupName=this.$ENV.TEXT_EXPLAIN.Action_Welcome_Text,this.moreQuantity=0,this.currentVoucherGroup="",this.isChangeNewVoucher=!1,this.selectedVoucher={},this.$refs["updateTierForm"].clearValidate(this.validateFields)},setupData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t.loading=!0,t.numbers=[],o=1;o<=100;o++)t.numbers.push(o);return e.next=5,t.getVoucherGroups();case 5:return e.next=7,t.getConditions();case 7:return e.next=9,t.getActions();case 9:return e.next=11,t.getPostActions();case 11:t.promotionTier=t.tierUpdate,t.currentVoucherGroup=t.promotionTier.voucherGroupId,t.setActionName(),t.promotionDetail.hasVoucher&&(t.selectedVoucher=t.promotionTier.voucherGroup,t.vouchers.some((function(e){return e.voucherGroupId==t.promotionTier.voucherGroupId}))&&t.checkIndexInfo(t.promotionTier.voucherGroupId),t.setVoucherGroupName()),t.setConditionName(),t.loading=!1;case 17:case"end":return e.stop()}}),e)})))()},setVoucherGroupName:function(){var t=this.promotionTier.voucherGroupId,e=this.vouchers.find((function(e){return e.voucherGroupId==t}));e?this.voucherGroupName=e.voucherGroupName:this.promotionTier.voucherGroupId=""},setConditionName:function(){var t=this.promotionTier.conditionRuleId,e=this.conditions.find((function(e){return e.conditionRuleId==t}));e?this.conditionName=e.ruleName:(this.conditionName=this.tierUpdate.conditionRule.ruleName,this.promotionTier.conditionRuleId="")},updateTier:function(){var t=this;this.$refs["updateTierForm"].validate((function(e){e&&(t.loading=!0,t.promotionDetail.hasVoucher&&!t.isChangeNewVoucher?t.promotionTier.moreQuantity=t.moreQuantity:t.promotionTier.voucherQuantity=t.newQuantity,t.$store.commit("promotion_detail/setUpdatePromotionTierParam",t.promotionTier),t.$store.dispatch("promotion_detail/updatePromotionTier").then((function(e){t.loading=!1,200==e.status?e.data?(t.$notify({title:"Success",message:"Update successful",type:"success"}),t.$emit("closeDialog")):(t.$emit("getPromotionDetail"),t.$notify({title:"Error",message:"Error when update, please try again",type:"danger"})):t.$notify({title:"Error",message:"Error when update, please try again",type:"danger"})})).catch((function(){t.loading=!1,t.$notify({title:"Error",message:"Error when update, please try again",type:"danger"})})))}))},checkIndexInfo:function(t){var e=this;this.voucherLoading=!0,this.$store.commit("voucher/setCheckIndexId",t),this.$store.dispatch("voucher/getIndexInfo").then((function(t){if(200!=t.status)e.$notify({title:"Error",message:"Cannot get Voucher info",type:"danger"});else{var o=e.voucherIndexInfo;e.promotionTier.fromIndex=o.fromIndex}e.voucherLoading=!1})).catch((function(){e.voucherLoading=!1,e.$notify({title:"Error",message:"Cannot get Voucher info",type:"danger"})}))},setActionName:function(){this.promotionDetail.postActionType>this.$ENV.POST_ACTION_TYPE.EMPTY&&(this.giftName=this.promotionTier.gift.name,this.promotionTier.gift.delFlg&&(this.promotionTier.giftId="")),this.promotionDetail.actionType>this.$ENV.ACTION_TYPE.EMPTY&&(this.actionName=this.promotionTier.action.name,this.promotionTier.action.delFlg&&(this.promotionTier.actionId=""))},changeSelectVoucher:function(t){var e=this.vouchers.find((function(e){return e.voucherGroupId==t}));e.gift&&(this.giftName=e.gift.name),e.action&&(this.actionName=e.action.name),this.selectedVoucher=e,this.promotionTier.actionId=e.actionId,this.promotionTier.giftId=e.giftId,t==this.currentVoucherGroup?(this.moreQuantity=0,this.newQuantity=0,this.isChangeNewVoucher=!1):(this.moreQuantity=0,this.isChangeNewVoucher=!0),this.checkIndexInfo(t)},getVoucherGroups:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.voucherLoading=!0,t.$store.commit("voucher/setActionType",t.actionType),t.$store.commit("voucher/setPostActionType",t.postActionType),t.$store.commit("voucher/setPageSize",0),t.$store.commit("voucher/setPageIndex",0),e.next=7,t.$store.dispatch("voucher/getVoucherList").then((function(e){t.voucherLoading=!1,t.$store.commit("voucher/setPageSize",10),t.$store.commit("voucher/setPageIndex",1),200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Voucher error !",type:"danger"})})).catch((function(){t.$store.commit("voucher/setPageSize",10),t.$store.commit("voucher/setPageIndex",1),t.voucherLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Voucher error !",type:"danger"})}));case 7:case"end":return e.stop()}}),e)})))()},getConditions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.conditionLoading=!0,e.next=3,t.$store.dispatch("voucher/getConditions").then((function(e){t.conditionLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Condition error !",type:"danger"})})).catch((function(){t.conditionLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Condition error !",type:"danger"})}));case 3:case"end":return e.stop()}}),e)})))()},getPostActions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.giftLoading=!0,o=t.discountType,t.$store.commit("voucher/setPostActionType",o),e.next=5,t.$store.dispatch("voucher/getPostAction").then((function(e){t.giftLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Gift error !",type:"danger"})})).catch((function(){t.giftLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Gift error !",type:"danger"})}));case 5:case"end":return e.stop()}}),e)})))()},getActions:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.actionLoading=!0,o=t.actionType,t.$store.commit("voucher/setActionType",o),e.next=5,t.$store.dispatch("voucher/getAction").then((function(e){t.actionLoading=!1,200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Action error !",type:"danger"})})).catch((function(){t.actionLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Action error !",type:"danger"})}));case 5:case"end":return e.stop()}}),e)})))()}}},k=S,$=(o("5deb"),o("b871"),Object(g["a"])(k,D,E,!1,null,"662e8490",null)),N=$.exports,A=o("c067");r["default"].use(l.a);var O={name:"promotion-action",directives:{"b-tooltip":c["b"]},props:{promotionDetail:Object,promotionTierParam:Array,promotionId:String},components:{CreateTier:x,UpdateTier:N,ActionDetail:A["default"]},data:function(){return{dialogTableVisible:!1,actionIdUpdate:"",giftIdUpdate:"",voucherGroupIdUpdate:"",conditionRuleIdUpdate:"",createLoading:!1,dlgLoading:!1,dialogRuleVisible:!1,updCondDiaglog:!1,updActDiaglog:!1,dialogVisible:!1,loading:!1,updateConditionRule:{},updateActionParam:{},updatePostActionParam:{}}},created:function(){},watch:{},computed:{promotionTiers:function(){return this.promotionTierParam?this.promotionTierParam:[]},actionType:function(){return this.promotionDetail.actionType},postActionType:function(){return this.promotionDetail.postActionType},hasVoucherBlock:function(){return this.promotionDetail.hasVoucher},publishBlock:function(){var t=this.promotionDetailParam.status;return t==this.$ENV.PROMOTION_STATUS.PUBLISH||t==this.$ENV.PROMOTION_STATUS.UNPUBLISH},expiredBlock:function(){var t=this.promotionDetailParam.status;return t==this.$ENV.PROMOTION_STATUS.EXPIRED},updateConditionRuleParam:function(){return this.updateConditionRule},conditionGroups:function(){return this.$store.state.condition.conditionGroups},conditionRule:function(){return this.$store.state.condition.conditionRule},action:function(){return this.$store.state.action.actionParam},promotionDetailParam:function(){return this.promotionDetail}},filters:{actionTypeFilter:function(t){switch(t){case 1:return"Discount amount of order";case 2:return"Discount percent of order";case 3:return"Discount shipping fee of order";case 4:return"Discount amount of item";case 5:return"Discount percent of item";case 6:return"Discount unit of item";case 7:return"Fixed price of item";case 8:return"Ladder price of item";case 9:return"Bundle price of item"}},postActionTypeFilter:function(t){switch(t){case 1:return"Gift products";case 2:return"Gift vouchers";case 3:return"Gift points";case 4:return"Gift game code"}}},methods:{openActionDetail:function(t){this.$store.commit("action/setId",t),this.$refs["actionDetailDialog"]&&this.$refs["actionDetailDialog"].setupData(),this.dialogTableVisible=!0},openRuleDialog:function(){this.dialogRuleVisible=!0,null!=this.$refs["ruleTable"]&&this.$refs["ruleTable"].getAvailableRules()},dialogRuleClose:function(){this.dialogRuleVisible=!1,this.getPromotionTier()},getPromotionTier:function(){var t=this;this.loading=!0,this.$store.dispatch("promotion_detail/getPromotionTier").then((function(){t.loading=!1})).catch((function(e){t.loading=!1,t.$notify({title:"Warning",message:e.message+", please try again.",type:"warning"})}))},createDialogClose:function(){this.clearStoreData(),this.getPromotionDetail(),this.$refs["createTier"]&&this.$refs["createTier"].clearData(),this.dialogVisible=!1},clearStoreData:function(){this.$store.commit("voucher/setIndexInfo",{}),this.$store.commit("voucher/setVoucherList",[]),this.$store.commit("voucher/setActions",[]),this.$store.commit("voucher/setPostActions",[]),this.$store.commit("voucher/setConditions",[]),this.$store.commit("promotion_detail/setTierUpdate",{})},updateDialogClose:function(){this.clearStoreData(),this.getPromotionDetail(),this.$refs["updateTier"]&&this.$refs["updateTier"].clearData(),this.updCondDiaglog=!1},getPromotionDetail:function(){this.$emit("getPromotionDetail")},updateTierFunc:function(){var t=this;this.dlgLoading=!0;var e=this.$refs["update-tier-drag"].updateTier();void 0!=e?(this.$store.commit("promotion_detail/setUpdatePromotionTierParam",e),this.$store.dispatch("promotion_detail/updatePromotionTier").then((function(){t.handleCloseUpdCond(),t.$notify({title:"Success",message:"Update successful",type:"success"}),t.dlgLoading=!1,t.loading=!0,t.getPromotionTier()})).catch((function(e){t.dlgLoading=!1,t.$notify({title:"Warning",message:e.message+", please try again.",type:"warning"})}))):this.dlgLoading=!1},handleCloseUpdCond:function(){this.updateActionParam={},this.updatePostActionParam={},this.updateConditionRule={},void 0!=this.$refs["update-tier-drag"]&&this.$refs["update-tier-drag"].resetData(),void 0!=this.$refs["condition-drag"]&&this.$refs["condition-drag"].resetData(),this.updCondDiaglog=!1},viewCondUpd:function(t){this.$store.commit("promotion_detail/setTierUpdate",t),this.$refs["updateTier"]&&this.$refs["updateTier"].setupData(),this.updCondDiaglog=!0},deletePromotionTier:function(t){var e=this;this.$confirm("This will permanently delete the file. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.loading=!0;var o=t.promotionTierId;e.$store.commit("promotion_detail/setDeleteTierId",o),e.$store.dispatch("promotion_detail/deletePromotionTier").then((function(t){e.loading=!1,200==t.status&&1==t.data?(e.$notify({title:"Success",message:"Delete successful",type:"success"}),e.getPromotionDetail()):e.$notify({icon:"el-icon-warning",title:"Error",message:"Delete error !",type:"danger"})})).catch((function(){e.loading=!1,e.$notify({icon:"el-icon-warning",title:"Error",message:"Delete error !",type:"danger"})}))}))},openDialog:function(){this.$refs["createTier"]&&(this.$refs["createTier"].clearData(),this.$refs["createTier"].setupData()),this.dialogVisible=!0}}},V=O,M=(o("18a0"),o("1f6d"),Object(g["a"])(V,y,_,!1,null,"691e2e03",null)),L=M.exports,R=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pd-5"},[o("el-row",{staticClass:"mt-2"},[o("el-col",{attrs:{span:22}},[o("h1",[t._v("USAGE INFOMATION")])]),o("el-col",{staticClass:"mt-2 mb-2",attrs:{span:24}},[o("label",{staticClass:"custom-tag"},[o("i",{staticClass:"el-icon-warning-outline mr-1"}),t._v(" Promotion can be used at "),o("b",[t._v(t._s(t.storeAppliedId.length)+" ")]),t._v(" store(s) ")])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:t.promotion.hasVoucher?10:24}},[o("el-card",[o("el-row",{staticClass:"mb-2"},[o("el-col",{attrs:{span:12}},[o("h3",[t._v("STORES")])]),o("el-col",{attrs:{span:12}},[o("el-button",{staticClass:"float-right",attrs:{icon:"el-icon-folder-checked",type:"success",size:"small"},on:{click:t.saveStore}},[t._v("Save changes")])],1)],1),t._l(t.groupStoreList,(function(e,i){return o("el-card",{key:i,staticClass:"mb-3 pb-2",attrs:{shadow:"never"}},[o("label",{staticClass:"mb-3"},[t._v("Group "+t._s(e.group))]),o("el-checkbox-group",{model:{value:t.storeAppliedId,callback:function(e){t.storeAppliedId=e},expression:"storeAppliedId"}},t._l(e.stores,(function(e){return o("el-col",{key:e.storeId,attrs:{span:12}},[o("el-checkbox",{attrs:{label:e.storeId,size:"medium"}},[o("span",{staticClass:"mb-0 store-name-size"},[o("small",[t._v(" "+t._s(t._f("storeNameFilter")(e.storeName))+" ")])])])],1)})),1)],1)}))],2)],1),t.promotion.hasVoucher?o("el-col",{attrs:{span:14}},[o("el-card",{staticClass:"mt-0"},[o("h3",[t._v("VOUCHER USAGE")]),o("label",{staticClass:"mr-2"},[t._v("Select Store ")]),o("el-select",{staticStyle:{width:"20vw"},attrs:{placeholder:"Select store to view usage"},on:{change:t.selectStore},model:{value:t.selectedStoreId,callback:function(e){t.selectedStoreId=e},expression:"selectedStoreId"}},t._l(t.allStores,(function(t,e){return o("el-option",{key:e,attrs:{value:t.storeId,label:t.storeName}})})),1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"mt-3",attrs:{height:"400",data:t.checkVouchers,"header-row-class-name":"custom-table","cell-class-name":"custom-table",border:""}},[o("el-table-column",{attrs:{label:"No.",type:"index"}}),o("el-table-column",{attrs:{label:"Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(e.row.voucherCode)+" ")])]}}],null,!1,616752649)}),o("el-table-column",{attrs:{label:"Customer"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.membership?o("label",[t._v("Guest")]):t._e(),null!=e.row.membership?o("label",[t._v(t._s(e.row.membership.fullname))]):t._e()]}}],null,!1,1729740029)}),o("el-table-column",{attrs:{label:"Detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.checkVoucher(e.row)}}},[t._v("View Detail")])]}}],null,!1,1013668586)})],1),o("div",{staticClass:"mt-2 d-flex justify-content-end"},[o("base-pagination",{attrs:{"page-count":t.pageCount},on:{input:t.changePage},model:{value:t.pagination.default,callback:function(e){t.$set(t.pagination,"default",e)},expression:"pagination.default"}})],1)],1)],1):t._e()],1),o("el-dialog",{attrs:{title:"Voucher Information",visible:t.dialogVisible,width:"70%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("check-voucher-info")],1)],1)},U=[],F=o("4739");r["default"].use(l.a);var G={components:{CheckVoucherInfo:F["a"]},name:"promotion-store",directives:{"b-tooltip":c["b"]},filters:{storeNameFilter:function(t){var e=30;return t.length>e?t.substring(0,e-3)+"...":t}},props:{voucherGroupParam:Object,promotionDetail:Object},created:function(){var t=this;this.$store.dispatch("promotion_detail/getStoreOfPromotion").then((function(){t.setupStoreData()})).catch((function(e){t.loading=!1,t.$message({message:e.message+", please try again.",type:"error"})})),this.$forceUpdate()},computed:{promotion:function(){return this.promotionDetail},checkVouchers:function(){return this.$store.state.promotion_detail.checkStoreVouchers},groupStoreList:function(){return this.$store.state.promotion_detail.storeOfPromo},storeRedempVoucher:function(){return this.$store.state.promotion_detail.storeVouchers},voucherQuantityParam:function(){return this.voucherGroupParam}},watch:{},data:function(){return{dialogVisible:!1,allStores:[],tableLoading:!1,storeAppliedId:[],isEditInfo:!1,redemped:0,quantity:0,pageCount:1,pagination:{default:1},selectedStoreId:""}},methods:{checkVoucher:function(t){var e=this;this.loading=!0,this.$store.commit("voucher/setCheckCode",t.voucherCode),this.$store.commit("voucher/setVoucherGroupId",t.voucherGroupId),this.$store.dispatch("voucher/checkVoucher").then((function(t){e.loading=!1,200==t.status?e.dialogVisible=!0:204==t.status?e.$notify({icon:"el-icon-warning",title:"Error",message:"Voucher not found",type:"warning"}):e.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get vouchers",type:"danger"})})).catch((function(){e.loading=!1,e.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get vouchers",type:"danger"})}))},format:function(t){return"".concat(t)+"/"+this.voucherQuantityParam.quantity},editMode:function(){console.log("cliked!"),this.isEditInfo=!this.isEditInfo,this.isEditInfo||this.setupStoreData()},saveStore:function(){var t=this;this.$emit("loadingStatus",!0);var e={listStoreId:this.storeAppliedId,promotionId:"",brandId:""};this.$store.commit("promotion_detail/setUpdateStore",e),this.$store.dispatch("promotion_detail/updateStoreOfPromotion").then((function(){t.isEditInfo=!t.isEditInfo,t.setupStoreData(),t.$emit("loadingStatus",!1),t.$message({message:"Update successful",type:"success"})})).catch((function(){t.$emit("loadingStatus",!1),t.$message({message:"Update failed",type:"error"})}))},setupStoreData:function(){var t=this;this.storeAppliedId=[],this.allStores=[],this.groupStoreList.forEach((function(e){var o=e.stores;o.forEach((function(e){e.isCheck&&t.storeAppliedId.push(e.storeId),t.allStores.push(e)}))}))},selectStore:function(t){this.$store.commit("promotion_detail/setCheckStoreId",t),this.pagination.default=1,this.changePage(1)},changePage:function(t){this.tableLoading=!0,this.$store.commit("promotion_detail/setCheckStorePageIndex",t),this.getVoucherList()},setPageCount:function(){var t=this.$store.state.promotion_detail.checkStorePageSize;this.pageCount=Math.ceil(this.$store.state.promotion_detail.checkStoreCounter/t)},getVoucherList:function(){var t=this;this.tableLoading=!0,this.$store.commit("promotion_detail/setPromotionId",this.$route.params.id),this.$store.dispatch("promotion_detail/checkStoreOfVoucher").then((function(e){t.tableLoading=!1,200!=e.status?t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when checking store",type:"danger"}):t.setPageCount()})).catch((function(){t.tableLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when checking store",type:"danger"})}))}}},B=G,z=(o("7e84"),Object(g["a"])(B,R,U,!1,null,null,null)),H=z.exports,q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pd-5"},[o("el-row",{staticClass:"mt-2"},[o("el-col",{attrs:{span:20}},[o("h1",[t._v("DISTRIBUTION INFOMATION")])]),o("el-col",{staticClass:"mt-2 mb-2",attrs:{span:24}},[o("label",{staticClass:"custom-tag"},[o("i",{staticClass:"el-icon-warning-outline mr-1"}),t._v(" Promotion is distributed to "),o("b",[t._v(t._s(t.channelApply.length)+" ")]),t._v(" channel(s) ")])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:t.promotion.hasVoucher?10:24}},[o("el-card",[o("el-row",[o("el-col",{attrs:{span:12}},[o("h3",[t._v("CHANNELS")])]),o("el-col",{attrs:{span:12}},[o("div",{staticClass:"float-right"},[o("el-button",{attrs:{icon:"el-icon-folder-checked",type:"success",size:"small"},on:{click:t.saveChannel}},[t._v("Save changes")])],1)])],1),o("el-row",{staticClass:"mt-2",attrs:{gutter:5}},[o("el-col",{attrs:{span:24}},t._l(t.groupChannelList,(function(e,i){return o("el-card",{key:i,staticClass:"mb-3 pb-2",attrs:{shadow:"never"}},[o("label",{staticClass:"mb-3"},[t._v("Group "+t._s(e.group))]),o("el-checkbox-group",{model:{value:t.channelApply,callback:function(e){t.channelApply=e},expression:"channelApply"}},t._l(e.channels,(function(e){return o("el-col",{key:e.channelId,attrs:{span:12}},[o("el-checkbox",{staticClass:"mb-3",attrs:{label:e.channelId,size:"medium"}},[o("span",{staticClass:"mb-0 channel-name-size"},[o("small",[t._v(" "+t._s(e.channelName)+" ")])])])],1)})),1)],1)})),1)],1)],1)],1),t.promotion.hasVoucher?o("el-col",{attrs:{span:14}},[o("el-card",{staticClass:"mt-0"},[o("h3",[t._v("VOUCHER DISTRIBUTION")]),o("label",{staticClass:"mr-2"},[t._v("Select Channel ")]),o("el-select",{staticStyle:{width:"20vw"},attrs:{placeholder:"Select channel to view distribution"},on:{change:t.selectChannel},model:{value:t.selectedChannelId,callback:function(e){t.selectedChannelId=e},expression:"selectedChannelId"}},t._l(t.allChannels,(function(t,e){return o("el-option",{key:e,attrs:{value:t.channelId,label:t.channelName}})})),1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"mt-3",attrs:{height:"400",data:t.checkVouchers,"header-row-class-name":"custom-table","cell-class-name":"custom-table",border:""}},[o("el-table-column",{attrs:{label:"No.",type:"index"}}),o("el-table-column",{attrs:{label:"Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(e.row.voucherCode)+" ")])]}}],null,!1,616752649)}),o("el-table-column",{attrs:{label:"Date"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isRedemped?o("label",[t._v(t._s(t._f("formatDate")(e.row.redempedDate)))]):t._e()]}}],null,!1,3814340627)}),o("el-table-column",{attrs:{label:"Game"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isRedemped?o("div",[e.row.gameCampaign?o("label",[t._v(" "+t._s(e.row.gameCampaign.name)+" ")]):t._e(),e.row.gameCampaign?t._e():o("label",[t._v(" N/A ")])]):t._e()]}}],null,!1,3978477250)}),o("el-table-column",{attrs:{label:"Customer"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.membership?o("label",[t._v("N/A")]):t._e(),null!=e.row.membership?o("label",[t._v(t._s(e.row.membership.fullname))]):t._e()]}}],null,!1,121472941)}),o("el-table-column",{attrs:{label:"Used"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isUsed?t._e():o("label",[t._v("N/A")]),e.row.isUsed?o("div",[e.row.store?o("label",[t._v(" "+t._s(e.row.store.storeName)+" ")]):t._e()]):t._e()]}}],null,!1,1878592861)})],1),o("div",{staticClass:"mt-2 d-flex justify-content-end"},[o("base-pagination",{attrs:{"page-count":t.pageCount},on:{input:t.changePage},model:{value:t.pagination.default,callback:function(e){t.$set(t.pagination,"default",e)},expression:"pagination.default"}})],1)],1)],1):t._e()],1)],1)},j=[];r["default"].use(l.a);var Q={name:"promotion-channel",directives:{"b-tooltip":c["b"]},filters:{formatDate:function(t){return p()(t).format("DD/MM/YYYY HH:mm")}},props:{voucherGroupParam:Object,promotionDetail:Object},created:function(){var t=this;this.$emit("loadingStatus",!0),this.$store.dispatch("promotion_detail/getChannelOfPromotion").then((function(){t.setupChannelData(),t.$emit("loadingStatus",!1)})).catch((function(e){t.loading=!1,t.$message({message:"PROMOTIONCHANNEL.VUE: "+e.message+", please try again.",type:"error"})})),this.$forceUpdate()},beforeDestroy:function(){this.$store.commit("promotion_detail/setCheckChannelId",""),this.$store.commit("promotion_detail/setCheckChannelPageSize",10),this.$store.commit("promotion_detail/setCheckChannelPageIndex",1),this.$store.commit("promotion_detail/setCheckChannelCounter",0),this.$store.commit("promotion_detail/setCheckChannelVoucher",[])},computed:{promotion:function(){return this.promotionDetail},checkVouchers:function(){return this.$store.state.promotion_detail.checkChannelVouchers},groupChannelList:function(){return this.$store.state.promotion_detail.channelOfPromo},channelRedempVoucher:function(){return this.$store.state.promotion_detail.channelVouchers},voucherQuantityParam:function(){return this.voucherGroupParam}},data:function(){return{loading:!1,tableLoading:!1,channelApply:[],isEditInfo:!1,pageCount:1,pagination:{default:1},allChannels:[],selectedChannelId:""}},methods:{format:function(t){return"".concat(t)+"/"+this.voucherQuantityParam.quantity},editMode:function(){this.setupChannelData()},saveChannel:function(){var t=this;this.loading=!0;var e={listChannelId:this.channelApply,promotionId:"",brandId:""};this.$store.commit("promotion_detail/setUpdateChannel",e),this.$store.dispatch("promotion_detail/updateChannelOfPromotion").then((function(e){t.loading=!1,200==e.status?(t.setupChannelData(),t.$notify({icon:"el-icon-warning",title:"Success",message:"Update successful",type:"success"})):t.$notify({icon:"el-icon-warning",title:"Error",message:"Update failed, please try again",type:"danger"})})).catch((function(){t.loading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Update failed, please try again",type:"danger"})}))},setupChannelData:function(){var t=this;this.channelApply=[],this.allChannels=[],this.groupChannelList.forEach((function(e){var o=e.channels;o.forEach((function(e){e.isCheck&&t.channelApply.push(e.channelId),t.allChannels.push(e)}))}))},selectChannel:function(t){this.$store.commit("promotion_detail/setCheckChannelId",t),this.pagination.default=1,this.changePage(1)},changePage:function(t){this.tableLoading=!0,this.$store.commit("promotion_detail/setCheckChannelPageIndex",t),this.getVoucherList()},setPageCount:function(){var t=this.$store.state.promotion_detail.checkChannelPageSize;this.pageCount=Math.ceil(this.$store.state.promotion_detail.checkChannelCounter/t)},getVoucherList:function(){var t=this;this.tableLoading=!0,this.$store.commit("promotion_detail/setPromotionId",this.$route.params.id),this.$store.dispatch("promotion_detail/checkChannelOfVoucher").then((function(e){t.tableLoading=!1,200!=e.status?t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when checking channel",type:"danger"}):t.setPageCount()})).catch((function(){t.tableLoading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when checking channel",type:"danger"})}))}}},Y=Q,X=(o("2d17"),Object(g["a"])(Y,q,j,!1,null,"84a5d7da",null)),W=X.exports,Z=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"font-size":"18px"},attrs:{id:"promoConfig"}},[o("div",{staticClass:"card-body"},[o("el-form",{ref:"configForm",attrs:{"show-message":!0,"inline-message":!0,model:t.promotion,"label-width":"9.5vw","label-position":"left",rules:t.formRule}},[o("el-card",{staticClass:"custom-card",attrs:{shadow:"never"}},[o("el-row",{attrs:{justify:"space-between"}},[o("el-col",{attrs:{span:8}},[o("label",[o("b",[t._v(" CONFIGURATION ")])])]),o("el-col",{attrs:{span:16}},[o("div",{staticClass:"float-right"},[o("label",{staticStyle:{"font-size":"0.95vw"}},[t._v("Last update: "),o("b",[t._v(t._s(t._f("formatDate")(t.promotion.updDate)))])]),t.publishBlock||t.expiredBlock?t._e():o("span",[o("el-divider",{attrs:{direction:"vertical"}}),t.isEdit?t._e():o("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:t.editMode}},[t._v("Edit")]),t.isEdit?o("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.editMode}},[t._v("Cancel")]):t._e(),t.isEdit?o("el-button",{attrs:{size:"mini",icon:"el-icon-document",type:"primary"},on:{click:t.updateInfo}},[t._v("Save")]):t._e()],1)])]),o("el-col",{attrs:{span:24}},[o("el-divider",{staticClass:"mt-1 mb-1"})],1)],1),t.isEdit?t._e():o("el-row",[o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("el-col",{attrs:{span:10}},[o("label",[o("b",[t._v("Exclusive: ")]),t._v(" "+t._s(t._f("exclusiveFilter")(t.promotion.exclusive))+" ")])]),o("el-col",{attrs:{span:8}},[o("label",[o("b",[t._v("Payment: ")]),t._v(t._s(t._f("paymentFilter")(t.promotion.paymentMethod))+" ")])])],1),o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("el-col",{attrs:{span:10}},[o("label",[o("b",[t._v("Sale mode: ")]),t._v(" "+t._s(t._f("saleModeFilter")(t.promotion.saleMode))+" ")])]),o("el-col",{attrs:{span:8}},[o("label",[o("b",[t._v("Apply by: ")]),t._v(t._s(t._f("applyFilter")(t.promotion.applyBy))+" ")])])],1),o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("el-col",{attrs:{span:10}},[o("label",[o("b",[t._v("Customer type: ")]),t._v(t._s(t._f("memberTypeFilter")(t.promotion.forMembership))+" ")])]),o("el-col",{attrs:{span:8}},[o("label",[o("b",[t._v("Gender: ")]),t._v(t._s(t._f("genderFilter")(t.promotion.gender))+" ")])])],1),t.membershipBlock?o("el-col",{staticClass:"mt-3",attrs:{span:24}},[o("label",[o("b",[t._v("Member Levels: ")]),t._v(" "+t._s(t.selectedLevels)+" ")])]):t._e()],1),t.isEdit?o("div",[o("el-row",{staticClass:"mt-3 mb-0"},[o("el-col",{staticClass:"mb-0",staticStyle:{height:"55px"},attrs:{span:24}},[o("el-form-item",{attrs:{label:"Exclusive"}},[o("el-select",{staticStyle:{width:"10vw"},attrs:{disabled:!t.isEdit,placeholder:"Select",size:"small"},model:{value:t.promotion.exclusive,callback:function(e){t.$set(t.promotion,"exclusive",e)},expression:"promotion.exclusive"}},t._l(t.exclusives,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1),o("el-row",[o("el-form-item",{staticClass:"mb-1 mt-0",attrs:{prop:"saleMode",label:"Sale mode"}},[o("el-checkbox-group",{attrs:{fill:"#67C23A",disabled:!t.isEdit,size:"medium"},on:{change:t.changeSaleMode},model:{value:t.saleModes,callback:function(e){t.saleModes=e},expression:"saleModes"}},[o("el-checkbox",{attrs:{value:"Eat-in",label:"Eat-in",name:"salesMode"}}),o("el-checkbox",{attrs:{value:"Take-away",label:"Take-away",name:"salesMode"}}),o("el-checkbox",{attrs:{value:"Delivery",label:"Delivery",name:"salesMode"}})],1)],1),o("el-form-item",{staticClass:"mb-1",attrs:{prop:"applyBy",label:"Apply by"}},[o("el-checkbox-group",{attrs:{size:"medium",fill:"#67C23A",disabled:!t.isEdit},on:{change:t.changeApplyBy},model:{value:t.appliesBy,callback:function(e){t.appliesBy=e},expression:"appliesBy"}},[o("el-checkbox",{attrs:{label:"Online",value:"Online",name:"applyBy"}}),o("el-checkbox",{attrs:{label:"Store",value:"Store",name:"applyBy"}})],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{staticClass:"mb-1",attrs:{prop:"forMembership",label:"Target customer"}},[o("el-checkbox-group",{attrs:{size:"medium",fill:"#67C23A",disabled:!t.isEdit},on:{change:t.changeMembership},model:{value:t.forMembership,callback:function(e){t.forMembership=e},expression:"forMembership"}},[o("el-checkbox",{attrs:{label:"Membership",value:"Membership",name:"forMembership"}}),o("el-checkbox",{attrs:{label:"Guest",value:"Guest",name:"forMembership"}})],1)],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{staticClass:"mb-1 p-0",attrs:{prop:"gender",label:"Customer gender"}},[o("el-checkbox-group",{attrs:{size:"medium",fill:"#67C23A",disabled:!t.isEdit},on:{change:t.changeGender},model:{value:t.genders,callback:function(e){t.genders=e},expression:"genders"}},[o("el-checkbox",{attrs:{label:"Male",value:"Male",name:"gender"}}),o("el-checkbox",{attrs:{label:"Female",value:"Female",name:"gender"}})],1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{staticClass:"mb-1 p-0",attrs:{prop:"paymentMethod",label:"Payment"}},[o("el-checkbox-group",{attrs:{size:"medium",fill:"#67C23A",disabled:!t.isEdit},on:{change:t.changePayment},model:{value:t.paymentMethods,callback:function(e){t.paymentMethods=e},expression:"paymentMethods"}},[o("el-checkbox",{attrs:{label:"Cash",value:"Cash",name:"payment"}}),o("el-checkbox",{attrs:{label:"Credit Cards",value:"Credit Cards",name:"payment"}}),o("el-checkbox",{attrs:{label:"Bank Transfers",value:"Bank Transfers",name:"payment"}}),o("el-checkbox",{attrs:{label:"eWallets",value:"eWallets",name:"payment"}}),o("el-checkbox",{attrs:{label:"Mobile Banking",value:"Mobile Banking",name:"payment"}}),o("el-checkbox",{attrs:{label:"COD",value:"COD",name:"payment"}})],1)],1)],1),t.membershipBlock?o("el-col",{attrs:{span:24}},[o("el-form-item",{staticClass:"mb-1",attrs:{prop:"memberLevelMapping",label:"Member Levels"}},[o("el-select",{staticStyle:{width:"20vw"},attrs:{disabled:!t.isEdit,placeholder:"Select",size:"small",multiple:"","collapse-tags":""},model:{value:t.promotion.memberLevelMapping,callback:function(e){t.$set(t.promotion,"memberLevelMapping",e)},expression:"promotion.memberLevelMapping"}},t._l(t.memberLevels,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.memberLevelId}})})),1)],1)],1):t._e()],1)],1):t._e()],1)],1),o("el-row",[o("el-card",{staticClass:"mt-3 custom-card",attrs:{shadow:"never"}},[o("el-row",[o("el-col",{attrs:{span:24}},[o("label",[o("b",[t._v(" TIMEFRAME SETTING")])])]),o("el-col",{attrs:{span:24}},[o("el-divider",{staticClass:"mt-1 mb-1"})],1),o("el-col",{staticClass:"card card-body mt-3",attrs:{span:24}},[o("label",[o("i",{staticClass:"el-icon-date"}),t._v(" "),o("b",[t._v(" Particular days in week ")])]),o("el-row",{staticClass:"mt-2",attrs:{gutter:20}},[o("el-checkbox-group",{on:{change:t.dayFilterChange},model:{value:t.dayFilterArray,callback:function(e){t.dayFilterArray=e},expression:"dayFilterArray"}},t._l(t.dayFilterOptions,(function(e){return o("el-col",{key:e.value,attrs:{span:3}},[o("el-checkbox",{attrs:{label:e.value}},[t._v(" "+t._s(e.label)+" ")])],1)})),1)],1),o("el-col",{attrs:{span:24}},[t.publishBlock||t.expiredBlock?t._e():o("el-button",{staticClass:"float-right",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.updateDayFilter(t.dayFilterParam)}}},[t._v("Save")])],1)],1),o("el-col",{staticClass:"card card-body mt-3",attrs:{span:24}},[o("label",[o("i",{staticClass:"el-icon-time"}),t._v(" "),o("b",[t._v(" Specificed hours in day ")])]),o("el-row",{staticClass:"mt-2",attrs:{gutter:20}},[o("el-checkbox-group",{on:{change:t.hourFilterChange},model:{value:t.hourFilterArray,callback:function(e){t.hourFilterArray=e},expression:"hourFilterArray"}},t._l(t.hourFilterOptions,(function(e){return o("el-col",{key:e.value,attrs:{span:4}},[o("el-checkbox",{attrs:{label:e.value}},[t._v(" "+t._s(e.label)+" ")])],1)})),1)],1),o("el-col",{attrs:{span:24}},[t.publishBlock||t.expiredBlock?t._e():o("el-button",{staticClass:"float-right",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.updateHourFilter(t.hourFilterParam)}}},[t._v("Save")])],1)],1)],1)],1)],1),o("el-form",{ref:"mediaForm",attrs:{rules:t.mediaRule,model:t.promotion,"label-position":"top"}},[o("el-card",{staticClass:"mt-3 custom-card",attrs:{shadow:"never"}},[o("el-row",[o("el-col",{attrs:{span:10}},[o("label",[o("b",[t._v(" MEDIA")])])]),o("el-col",{attrs:{span:14}},[o("label",{staticClass:"float-right",staticStyle:{"font-size":"0.95vw"}},[t._v("Last update: "),o("b",[t._v(t._s(t._f("formatDate")(t.promotion.updDate)))])])]),o("el-col",{attrs:{span:24}},[o("el-divider",{staticClass:"mt-1 mb-1"})],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-row",{staticClass:"mt-3"},[o("el-col",{attrs:{span:12}},[o("label",[o("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),o("b",[t._v(" Description ")])])]),o("el-col",{attrs:{span:12}},[t.expiredBlock?t._e():o("span",{staticClass:"float-right"},[t.isEditDescription?t._e():o("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:t.editDescriptionMode}},[t._v("Edit")]),t.isEditDescription?o("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.editDescriptionMode}},[t._v("Cancel")]):t._e(),t.isEditDescription?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.updateDescription}},[t._v("Save")]):t._e()],1)])],1),t.isEditDescription?t._e():o("el-card",{attrs:{shadow:"never"}},[o("el-row",[o("el-col",{attrs:{span:24}},[o("pre",{staticStyle:{"min-height":"20vh"}},[t._v(t._s(t.promotion.description))])])],1)],1),o("el-row",{directives:[{name:"show",rawName:"v-show",value:t.isEditDescription,expression:"isEditDescription"}]},[o("el-form-item",{attrs:{prop:"description","label-width":"0px"}},[o("el-input",{attrs:{type:"textarea",rows:15,resize:"none",placeholder:"Please input",maxlength:4e3},model:{value:t.promotion.description,callback:function(e){t.$set(t.promotion,"description",e)},expression:"promotion.description"}})],1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-row",{attrs:{gutter:13}},[o("el-col",{attrs:{span:24}},[o("el-col",{attrs:{span:24}},[o("label",{staticClass:"mt-3",staticStyle:{color:"black"}},[o("i",{staticClass:"el-icon-picture-outline"}),t._v(" "),o("b",[t._v(" Image")])])]),o("el-col",{attrs:{span:24}},[""!=t.promotion.imgUrl||null!=t.promotion.imgUrl?o("el-aside",[o("img",{attrs:{src:t.promotion.imgUrl,alt:t.promotion.imgUrl,width:"300px"}})]):t._e(),""==t.promotion.imgUrl||null==t.promotion.imgUrl?o("label",{staticStyle:{color:"grey"}},[t._v("No data")]):t._e()],1),o("el-col",{attrs:{span:24}},[o("el-button",{attrs:{type:"text primary",size:"mini"},on:{click:t.openUpload}},[t._v("Upload image")])],1)],1)],1)],1)],1)],1)],1)],1),o("el-dialog",{attrs:{title:"Upload Image",visible:t.dialogUpload,width:"80%","before-close":t.dialogUploadClose,"close-on-click-modal":!1,"append-to-body":!0},on:{"update:visible":function(e){t.dialogUpload=e}}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[o("el-row",{attrs:{justify:"center",align:"center"}},[o("el-col",{attrs:{span:10}},[o("center",[o("el-upload",{attrs:{drag:"",action:"",multiple:!1,"http-request":t.uploadImage,"show-file-list":!1,accept:"image/png, image/jpeg"}},[o("center",[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[t._v(" Drop file here or "),o("em",[t._v("click to upload")])])])],1)],1)],1),o("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.imgLoading,expression:"imgLoading"}],attrs:{span:14}},[o("center",[t.image?o("img",{attrs:{width:"35%",src:t.image}}):t._e()])],1),o("el-col",{attrs:{span:24}},[o("div",{staticClass:"float-right"},[o("el-button",{on:{click:t.cancelImage}},[t._v("Cancel")]),o("el-button",{on:{click:t.updateImageOfPromotion}},[t._v("Save")])],1)])],1)],1)])],1)},K=[],J=(o("a4d3"),o("e01a"),o("a630"),o("3ca3"),o("2591"));r["default"].use(l.a);var tt={name:"promotion-config",directives:{"b-tooltip":c["b"]},computed:{membershipBlock:function(){return this.promotion.forMembership<=1||!!this.forMembership.some((function(t){return"Membership"==t}))},exclusives:function(){return this.$store.state.promotion.exclusives},memberLevels:function(){return this.$store.state.condition.levels},promotion:function(){return this.promotionParam},publishBlock:function(){var t=this.promotionParam.status;return 2==t||3==t},expiredBlock:function(){var t=this.promotionParam.status;return 4==t}},props:{promotionParam:Object,paymentVariable:Object},components:{},data:function(){var t=this,e=function(e,o,i){0==t.genders.length?i(new Error("Please select Gender")):i()},o=function(e,o,i){0==t.saleModes.length?i(new Error("Please select Sale Mode")):i()},i=function(e,o,i){0==t.appliesBy.length?i(new Error("Please select Apply By")):i()},a=function(e,o,i){0==t.forMembership.length?i(new Error("Please select Target Customer")):i()},n=function(e,o,i){0==t.paymentMethods.length?i(new Error("Please select Payment Method")):i()},r=function(e,o,i){0==t.promotion.memberLevelMapping.length?i(new Error("Please select Level")):i()};return{imgLoading:!1,mediaRule:{description:[{required:!0,message:"Please input Description",trigger:["blur","change"]}]},formRule:{memberLevelMapping:[{validator:r,message:"Please select Level"}],paymentMethod:[{validator:n,message:"Please select Payment Method",trigger:["blur","change"]}],Exclusive:[{require:!0,message:"Please select exclusive"}],gender:[{validator:e,message:"Please select Gender",trigger:["blur","change"]}],saleMode:[{validator:o,message:"Please select Sale Mode",trigger:["blur","change"]}],applyBy:[{validator:i,message:"Please select Apply By",trigger:["blur","change"]}],forMembership:[{validator:a,message:"Please select Target Customer",trigger:["blur","change"]}]},dayFilterOptions:[{value:Math.pow(2,0),label:"Sunday"},{value:Math.pow(2,1),label:"Monday"},{value:Math.pow(2,2),label:"Tuesday"},{value:Math.pow(2,3),label:"Wednesday"},{value:Math.pow(2,4),label:"Thursday"},{value:Math.pow(2,5),label:"Friday"},{value:Math.pow(2,6),label:"Saturday"}],exclusive:0,dayFilterParam:0,dayFilterArray:[],hourFilterArray:[],hourFilterParam:0,hourFilterOptions:[],currentLevelIdList:[],image:"",imageName:"",dialogUpload:!1,isEdit:!1,isEditDescription:!1,oldDate:{},oldDescription:"",saleModes:[],appliesBy:[],forMembership:[],genders:[],paymentMethods:[],forHoliday:"",loading:!1,selectedLevels:""}},watch:{promotion:function(){var t=this.promotion.saleMode;this.handleSaleMode(t);var e=this.promotion.applyBy;this.handleApplyBy(e);var o=this.promotion.forMembership;this.handleMembership(o);var i=this.promotion.gender;this.handleGender(i);var a=this.promotion.paymentMethod;this.handlePayment(a);var n=this.promotion.forHoliday;this.handleHoliday(n),this.setupDayFilterData(this.promotion.dayFilter),this.setupHourFilterData(this.promotion.hourFilter),this.setupData()}},mounted:function(){var t=this.promotion.saleMode;this.handleSaleMode(t);var e=this.promotion.applyBy;this.handleApplyBy(e);var o=this.promotion.forMembership;this.handleMembership(o);var i=this.promotion.gender;this.handleGender(i);var a=this.promotion.paymentMethod;this.handlePayment(a);var n=this.promotion.forHoliday;this.handleHoliday(n)},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.addDateFilterOptions();case 1:case"end":return e.stop()}}),e)})))()},methods:{setSelectedLevels:function(){var t=this;this.currentLevelIdList=this.promotion.memberLevelMapping,this.selectedLevels="";var e=Array.from(this.promotion.memberLevelMapping);e.forEach((function(e){var o=t.memberLevels.find((function(t){return t.memberLevelId==e}));""==t.selectedLevels?t.selectedLevels+=o.name:t.selectedLevels+=", "+o.name}))},setupData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getMemberLevels();case 2:case"end":return e.stop()}}),e)})))()},getMemberLevels:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("condition/getBrandLevel").then((function(e){200==e.status?t.setSelectedLevels():t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when get level of member. Code: "+e.status,type:"warning"})})).catch((function(e){console.log(e),t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when get level of member",type:"warning"})}));case 2:case"end":return e.stop()}}),e)})))()},updateHourFilter:function(t){var e=this;this.loading=!0,this.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var o={promotionId:"",hourFilter:t,updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"})};this.$store.commit("promotion_detail/setPromotionDetailUpdate",o),this.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(){e.loading=!1,e.$message({message:"Update successful",type:"success"})})).catch((function(t){e.loading=!1,e.$message({message:t.message+", please try again.",type:"error"})}))},updateDayFilter:function(t){var e=this;this.loading=!0,this.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var o={promotionId:"",dayFilter:t,updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"})};this.$store.commit("promotion_detail/setPromotionDetailUpdate",o),this.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(){e.loading=!1,e.$message({message:"Update successful",type:"success"})})).catch((function(t){e.loading=!1,e.$message({message:t.message+", please try again.",type:"error"})}))},setupHourFilterData:function(t){var e=this,o=this.hourFilterOptions;this.hourFilterArray=[],this.hourFilterParam=0,o.forEach((function(o){(o.value&t)>0&&(e.hourFilterArray.push(o.value),e.hourFilterParam+=o.value)}))},setupDayFilterData:function(t){var e=this,o=this.dayFilterOptions;this.dayFilterArray=[],this.dayFilterParam=0,o.forEach((function(o){(o.value&t)>0&&(e.dayFilterArray.push(o.value),e.dayFilterParam+=o.value)}))},dayFilterChange:function(t){var e=this;0==t.length||7==t.length?this.setupDayFilterData(127):(this.dayFilterParam=0,t.forEach((function(t){e.dayFilterParam+=t})))},hourFilterChange:function(t){var e=this;if(0==t.length){for(var o=0,i=0;i<24;i++)o+=Math.pow(2,i);this.setupHourFilterData(o)}else this.hourFilterParam=0,t.forEach((function(t){e.hourFilterParam+=t}))},addDateFilterOptions:function(){for(var t=0;t<24;t++)t<10?this.hourFilterOptions.push({value:Math.pow(2,t),label:"0"+t+":00"}):this.hourFilterOptions.push({value:Math.pow(2,t),label:t+":00"})},updateDescription:function(){var t=this;this.$refs["mediaForm"].validate((function(e){if(e){t.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var o=t.promotion;o.memberLevelMapping=null,o.promotionStoreMapping=null,t.currentLevelIdList.forEach((function(e){var i={memberLevelId:e,promotionId:t.promotion.promotionId};o.memberLevelMapping.push(i)})),t.$store.commit("promotion_detail/setPromotionDetailUpdate",o),t.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(e){t.loading=!1,t.oldData={},t.isEditDescription&&(t.isEditDescription=!t.isEditDescription),t.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),t.dialogUpload=!1,200==e.status?t.$notify({icon:"el-icon-warning",title:"Success",message:"Update successful",type:"success"}):t.$notify({icon:"el-icon-warning",title:"Error",message:"Update error, please try again",type:"warning"}),t.$emit("getPromotionDetail")})).catch((function(e){t.$notify({icon:"el-icon-warning",title:"Error",message:e,type:"warning"}),t.loading=!1,t.editDescriptionMode(),t.dialogUpload=!1}))}}))},updateInfo:function(){var t=this;this.$refs["configForm"].validate((function(e){if(e){t.loading=!0,t.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var o={promotionId:"",saleMode:t.promotion.saleMode,applyBy:t.promotion.applyBy,forMembership:t.promotion.forMembership,gender:t.promotion.gender,paymentMethod:t.promotion.paymentMethod,forHoliday:t.promotion.forHoliday,exclusive:t.promotion.exclusive,endDate:t.promotion.endDate,memberLevelMapping:[],updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),isAuto:t.promotion.isAuto,hasVoucher:t.promotion.hasVoucher};t.promotion.memberLevelMapping.forEach((function(e){var i={memberLevelId:e,promotionId:t.promotion.promotionId};o.memberLevelMapping.push(i)})),t.$store.commit("promotion_detail/setPromotionDetailUpdate",o),t.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(e){t.loading=!1,t.oldData={},t.isEdit&&(t.isEdit=!t.isEdit),t.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),t.dialogUpload=!1,200==e.status?(t.setupData(),t.$notify({icon:"el-icon-warning",title:"Success",message:"Update successful",type:"success"})):t.$notify({icon:"el-icon-warning",title:"Error",message:"Update error, please try again",type:"warning"})})).catch((function(){t.loading=!1,t.editMode(),t.dialogUpload=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Update error, please try again",type:"warning"})}))}}))},updateImageOfPromotion:function(){var t=this;this.loading=!0,this.$store.commit("promotion_detail/setPromotionDetailUpdate",{});var e=this.promotion;e.imgUrl=this.image,e.promotionStoreMapping=null,this.$store.commit("promotion_detail/setPromotionDetailUpdate",e),this.$store.dispatch("promotion_detail/updatePromotionDetail").then((function(e){t.loading=!1,t.oldData={},t.isEdit&&(t.isEdit=!t.isEdit),t.promotion.updDate=(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),t.promotion.imgUrl=t.image,t.dialogUpload=!1,t.image={},200==e.status&&(t.$notify({icon:"el-icon-warning",title:"Success",message:"Update successful",type:"success"}),t.$emit("getPromotionDetail"))})).catch((function(){t.loading=!1,t.editMode(),t.dialogUpload=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Update error, please try again",type:"warning"})}))},editDescriptionMode:function(){this.isEditDescription=!this.isEditDescription,this.isEditDescription?this.oldDescription=this.promotion.description:(this.promotion.description=this.oldDescription,this.oldDescription=""),console.log(this.promotion.description)},editMode:function(){this.isEdit=!this.isEdit,this.isEdit?this.oldData={saleMode:this.promotion.saleMode,applyBy:this.promotion.applyBy,forMembership:this.promotion.forMembership,gender:this.promotion.gender,paymentMethod:this.promotion.paymentMethod,forHoliday:this.promotion.forHoliday,exclusive:this.promotion.exclusive,memberLevelMapping:this.promotion.memberLevelMapping}:(this.handleSaleMode(this.oldData.saleMode),this.promotion.saleMode=this.oldData.saleMode,this.handleApplyBy(this.oldData.applyBy),this.promotion.applyBy=this.oldData.applyBy,this.handleMembership(this.oldData.forMembership),this.promotion.forMembership=this.oldData.forMembership,this.handleGender(this.oldData.gender),this.promotion.gender=this.oldData.gender,this.handlePayment(this.oldData.paymentMethod),this.promotion.paymentMethod=this.oldData.paymentMethod,this.handleHoliday(this.oldData.forHoliday),this.promotion.forHoliday=this.oldData.forHoliday,this.promotion.exclusive=this.oldData.exclusive,this.promotion.memberLevelMapping=this.oldData.memberLevelMapping,this.oldData={})},changeHoliday:function(t){this.promotion.forHoliday="Yes"==t?1:0},handleHoliday:function(t){this.forHoliday=t?"Yes":"No"},changeGender:function(t){var e=this;console.log("change gender"),this.promotion.gender=0,t.forEach((function(t){switch(t){case"Male":e.promotion.gender+=1;break;case"Female":e.promotion.gender+=2;break}}))},handleGender:function(t){this.genders=[],(1&t)>0&&this.genders.push("Male"),(2&t)>0&&this.genders.push("Female")},changePayment:function(t){var e=this;this.promotion.paymentMethod=0,t.forEach((function(t){switch(t){case"Cash":e.promotion.paymentMethod+=e.$ENV.PAYMENT.CASH;break;case"Credit Cards":e.promotion.paymentMethod+=e.$ENV.PAYMENT.CREDIT_CARDS;break;case"Bank Transfers":e.promotion.paymentMethod+=e.$ENV.PAYMENT.BANK_TRANSFERS;break;case"eWallets":e.promotion.paymentMethod+=e.$ENV.PAYMENT.EWALLETS;break;case"Mobile Banking":e.promotion.paymentMethod+=e.$ENV.PAYMENT.MOBILE_BANKING;break;case"COD":e.promotion.paymentMethod+=e.$ENV.PAYMENT.COD;break}}))},handlePayment:function(t){this.paymentMethods=[],(1&t)>0&&this.paymentMethods.push("Cash"),(2&t)>0&&this.paymentMethods.push("Credit Cards"),(4&t)>0&&this.paymentMethods.push("Bank Transfers"),(8&t)>0&&this.paymentMethods.push("eWallets"),(16&t)>0&&this.paymentMethods.push("Mobile Banking"),(32&t)>0&&this.paymentMethods.push("COD")},changeSaleMode:function(t){var e=this;this.promotion.saleMode=0,t.forEach((function(t){switch(t){case"Eat-in":e.promotion.saleMode+=1;break;case"Take-away":e.promotion.saleMode+=2;break;case"Delivery":e.promotion.saleMode+=4;break}}))},handleSaleMode:function(t){this.saleModes=[],(1&t)>0&&this.saleModes.push("Eat-in"),(2&t)>0&&this.saleModes.push("Take-away"),(4&t)>0&&this.saleModes.push("Delivery")},changeMembership:function(t){var e=this;this.promotion.forMembership=0,2!=t.length&&t.forEach((function(t){switch(t){case"Membership":e.promotion.forMembership=1;break;case"Guest":e.promotion.forMembership=2;break}}))},handleMembership:function(t){this.forMembership=[],0==t&&(this.forMembership.push("Membership"),this.forMembership.push("Guest")),1==t&&this.forMembership.push("Membership"),2==t&&this.forMembership.push("Guest")},changeApplyBy:function(t){var e=this;this.promotion.applyBy=0,t.forEach((function(t){switch(t){case"Store":e.promotion.applyBy+=1;break;case"Online":e.promotion.applyBy+=2;break}}))},handleApplyBy:function(t){this.appliesBy=[],(1&t)>0&&this.appliesBy.push("Store"),(2&t)>0&&this.appliesBy.push("Online")},openUpload:function(){this.dialogUpload=!0},dialogUploadClose:function(){this.dialogUpload=!1},expired:function(){this.promotion.status=this.$ENV.PROMOTION_STATUS.EXPIRED},publish:function(){this.promotion.status=this.$ENV.PROMOTION_STATUS.PUBLISH},cancelImage:function(){void 0!=this.imageData&&this.deleteOldPic(),this.dialogUpload=!1},deleteOldPic:function(){var t=this,e=J["a"].storage().ref("".concat(this.imageData.name));e.delete().then((function(){t.dialogUpload=!1})).catch((function(){t.dialogUpload=!1,t.$message({showClose:!0,message:"Something was wrong, please try again",type:"error"})})),this.imageName="",this.image=""},uploadImage:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function o(){var i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.imgLoading=!0,""!=e.image&&null!=e.image&&e.deleteOldPic(),e.image=null,e.imageData=t.file,i=J["a"].storage().ref("".concat(e.imageData.name)).put(e.imageData),i.on("state_changed",(function(t){e.uploadValue=t.bytesTransferred/t.totalBytes*100}),(function(t){console.log(t.message)}),(function(){e.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(t){e.image=t,e.imageName=e.imageData.name,e.imgLoading=!1}))}));case 6:case"end":return o.stop()}}),o)})))()}},filters:{saleModeFilter:function(t){var e="";return(1&t)>0&&(0==e.length?e+="Eat-in":e+=", Eat-in"),(2&t)>0&&(0==e.length?e+="Take-away":e+=", Take-away"),(4&t)>0&&(0==e.length?e+="Delivery":e+=", Delivery"),e},memberTypeFilter:function(t){return 0==t?"Guest, Membership":2==t?"Guest":1==t?"Membership":void 0},applyFilter:function(t){var e="";return(1&t)>0&&(0==e.length?e+="Store":e+=", Store"),(2&t)>0&&(0==e.length?e+="Online":e+=", Online"),e},paymentFilter:function(t){var e="";return(1&t)>0&&(0==e.length?e+="Cash":e+=", Cash"),(2&t)>0&&(0==e.length?e+="Credit cards":e+=", Credit cards"),(4&t)>0&&(0==e.length?e+="Bank transfers":e+=", Bank transfers"),(8&t)>0&&(0==e.length?e+="eWallets":e+=", eWallets"),(16&t)>0&&(0==e.length?e+="Mobile banking":e+=", Mobile banking"),(32&t)>0&&(0==e.length?e+="COD":e+=", COD"),e},genderFilter:function(t){var e="";return(1&t)>0&&(0==e.length?e+="Male":e+=", Male"),(2&t)>0&&(0==e.length?e+="Female":e+=", Female"),e},formatDate:function(t){return p()(t).format("DD/MM/YYYY HH:mm")},exclusiveFilter:function(t){switch(t){case 0:return"None";case 1:return"Global";case 2:return"Level Order";case 3:return"Level Product";case 4:return"Level Shipping";case 5:return"Level Gift"}}}},et=tt,ot=(o("8542"),Object(g["a"])(et,Z,K,!1,null,null,null)),it=ot.exports,at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pd-5"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-card",{staticClass:"mt-0"},[o("h3",[t._v("TRANSACTION")]),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"mt-3",attrs:{height:"400",data:t.trans,border:""}},[o("el-table-column",{attrs:{label:"No.",type:"index"}}),o("el-table-column",{attrs:{label:"Order ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{staticClass:"tag-custom",attrs:{effect:"dark",size:"medium",type:"success"}},[t._v(" "+t._s(e.row.order.CustomerOrderInfo.Id)+" ")])]}}])}),o("el-table-column",{attrs:{label:"Date"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(t._f("formatDate")(e.row.order.CustomerOrderInfo.BookingDate)))])]}}])}),o("el-table-column",{attrs:{label:"Discount"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.order.Discount))])]}}])}),o("el-table-column",{attrs:{label:"Total Amount"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.order.FinalAmount))])]}}])}),o("el-table-column",{attrs:{label:"Detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.viewTransDetail(e.row)}}},[t._v("View Detail")])]}}])})],1),o("div",{staticClass:"mt-2 d-flex justify-content-end"},[o("base-pagination",{attrs:{"page-count":t.pageCount},on:{input:t.changePage},model:{value:t.pagination.default,callback:function(e){t.$set(t.pagination,"default",e)},expression:"pagination.default"}})],1)],1)],1)],1),o("el-dialog",{attrs:{title:"Transaction Detail",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("trans-detail")],1)],1)},nt=[],rt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pd-5",staticStyle:{"font-size":"1rem"}},[o("el-row",[o("el-col",{staticClass:"vertical-split",attrs:{span:6}},[o("h2",[t._v("Order Information")]),o("label",[t._v("ID "),o("el-tag",{attrs:{effect:"dark"}},[o("b",[t._v(" "+t._s(t.trans.order.CustomerOrderInfo.Id))])])],1),o("br"),o("label",[t._v("Date "),o("b",[t._v(" "+t._s(t._f("formatDate")(t.trans.order.CustomerOrderInfo.BookingDate))+" ")])])]),o("el-col",{staticClass:"vertical-split",attrs:{span:6}},[o("h2",[t._v("Store")]),o("p",[t._v(t._s(t.trans.order.CustomerOrderInfo.Attributes.StoreInfo.StoreId))])]),o("el-col",{staticClass:"vertical-split",attrs:{span:6}},[o("h2",[t._v("Customer")]),o("p",[t._v(t._s(t.trans.order.CustomerOrderInfo.Customer.CustomerName))]),o("p",[t._v(t._s(t.trans.order.CustomerOrderInfo.Customer.CustomerPhoneNo))])]),o("el-col",{staticClass:"vertical-split",attrs:{span:6}},[o("el-col",{attrs:{span:24}},[t._v(" Total: "),o("b",[t._v(t._s(t.trans.order.FinalAmount))])]),o("el-col",{attrs:{span:24}},[t._v(" Sub Total: "),o("b",[t._v(t._s(t.trans.order.TotalAmount))])]),o("el-col",{attrs:{span:24}},[t._v(" Discount: "),o("b",[t._v(t._s(t.trans.order.Discount))])]),o("el-col",{attrs:{span:24}},[t._v(" Point: "),o("b",[t._v(t._s(t.trans.order.BonusPoint))])])],1)],1),o("el-divider"),o("el-row",{attrs:{gutter:20}},[t.trans.order.CustomerOrderInfo.Vouchers.length>0?o("el-col",{attrs:{span:8}},[o("h3",[t._v("Voucher")]),o("el-table",{attrs:{border:"",data:t.trans.order.CustomerOrderInfo.Vouchers}},[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{label:"Voucher Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.VoucherCode?o("label",[t._v(" "+t._s(e.row.PromotionCode)+"-"+t._s(e.row.VoucherCode))]):t._e(),null==e.row.VoucherCode?o("label",[t._v(" "+t._s(e.row.PromotionCode))]):t._e()]}}],null,!1,3152101941)})],1)],1):t._e(),o("el-col",{attrs:{span:t.trans.order.CustomerOrderInfo.Vouchers.length>0?16:24}},[o("h3",[t._v("Product")]),o("el-table",{attrs:{border:"",data:t.trans.order.CustomerOrderInfo.CartItems}},[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{label:"Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(e.row.ProductCode))])]}}])}),o("el-table-column",{attrs:{label:"Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(e.row.ProductName))])]}}])}),o("el-table-column",{attrs:{label:"Image"},scopedSlots:t._u([{key:"default",fn:function(t){return[o("img",{attrs:{src:t.row.UrlImg,width:"40"}})]}}])}),o("el-table-column",{attrs:{label:"Quantity"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.Quantity))])]}}])}),o("el-table-column",{attrs:{label:"Unit Price"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.UnitPrice))])]}}])}),o("el-table-column",{attrs:{label:"Sub Total"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.SubTotal))])]}}])}),o("el-table-column",{attrs:{label:"Discount"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.Discount))])]}}])}),o("el-table-column",{attrs:{label:"Total"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.Total))])]}}])})],1)],1)],1),o("el-divider"),t.trans.order.Gift.length>0?o("el-row",[o("h3",[t._v("Gift")]),o("el-table",{attrs:{border:"",data:t.trans.order.Gift}},[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{label:"Game Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(e.row.gameCode))])]}}],null,!1,911633095)}),o("el-table-column",{attrs:{label:"Product Code"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(e.row.productCode))])]}}],null,!1,3388018210)}),o("el-table-column",{attrs:{label:"Product Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.productName))])]}}],null,!1,3899921963)}),o("el-table-column",{attrs:{label:"Promotion Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",[t._v(" "+t._s(e.row.promotionName))])]}}],null,!1,3522951763)})],1)],1):t._e()],1)},st=[];r["default"].use(l.a);var lt={name:"trans-detail",directives:{"b-tooltip":c["b"]},filters:{formatDate:function(t){return p()(t).format("DD/MM/YYYY HH:mm")}},props:{},created:function(){},computed:{trans:function(){return this.$store.state.transaction.transDetail}},watch:{},data:function(){return{dialogVisible:!1,allStores:[],tableLoading:!1,storeAppliedId:[],isEditInfo:!1,redemped:0,quantity:0,pageCount:1,pagination:{default:1},selectedStoreId:""}},methods:{}},ct=lt,ut=(o("306d"),Object(g["a"])(ct,rt,st,!1,null,"7cf57cf6",null)),dt=ut.exports;r["default"].use(l.a);var mt={components:{TransDetail:dt},name:"promotion-trans",directives:{"b-tooltip":c["b"]},filters:{formatDate:function(t){return p()(t).format("DD/MM/YYYY HH:mm")}},props:{},created:function(){this.getTransaction()},computed:{trans:function(){return this.$store.state.transaction.transaction}},watch:{},data:function(){return{dialogVisible:!1,allStores:[],tableLoading:!1,storeAppliedId:[],isEditInfo:!1,redemped:0,quantity:0,pageCount:1,pagination:{default:1},selectedStoreId:""}},methods:{viewTransDetail:function(t){this.$store.commit("transaction/setTransDetail",t),this.dialogVisible=!0},changePage:function(t){this.tableLoading=!0,this.$store.commit("transaction/setPageIndex",t),this.getTransaction()},setPageCount:function(){var t=this.$store.state.transaction.pageSize;this.pageCount=Math.ceil(this.$store.state.transaction.counter/t)},getTransaction:function(){var t=this;this.tableLoading=!0,this.$store.commit("transaction/setPromotionId",this.$route.params.id),this.$store.commit("transaction/setPageIndex",this.pagination.default),this.$store.dispatch("transaction/getTransaction").then((function(e){t.tableLoading=!1,200!=e.status?t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when getting transaction",type:"danger"}):t.setPageCount()})).catch((function(e){t.tableLoading=!1,console.log(e),t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when getting transaction",type:"danger"})}))}}},pt=mt,ht=Object(g["a"])(pt,at,nt,!1,null,null,null),ft=ht.exports;r["default"].use(l.a);var gt={directives:{"b-tooltip":c["b"]},components:{PromotionInfo:b,PromotionAction:L,PromotionStore:H,PromotionChannel:W,PromotionConfigure:it,PromotionTrans:ft},computed:{promotionDetail:function(){return this.$store.state.promotion_detail.promotionDetail},promotionTier:function(){return this.$store.state.promotion_detail.promotionDetail.promotionTier},voucherGroup:function(){return this.$store.state.promotion_detail.promotionDetail.voucherGroup},paymentVariable:function(){return this.$ENV.PAYMENT},vouchers:function(){return this.$store.state.voucher.vouchers}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,o=t.$route.params.id,t.$store.commit("promotion_detail/setPromotionId",o),e.next=5,t.getPromotionDetail();case 5:t.setExclusiveParams();case 6:case"end":return e.stop()}}),e)})))()},beforeCreate:function(){window.scrollTo(0,0)},beforeDestroy:function(){this.$store.commit("promotion_detail/clearPromotionDetail"),this.$store.commit("promotion_detail/clearPromotionTiers")},data:function(){return{headerClass:"header pb-8 pt-5 pt-lg-8 d-flex align-items-center img-fluid",headerStyle:"",loading:!1,isEditInfo:!1}},methods:{setExclusiveParams:function(){var t=[{label:"None",value:0},{label:"Global",value:1}],e=this.promotionDetail.actionType,o=this.promotionDetail.postActionType;if(e){var i=this.$ENV.ACTION_TYPE;e<i.ORDER_SHIPPING?t.push({label:"Level-Order",value:this.$ENV.EXCLUSIVE.LEVEL_ORDER}):e==i.ORDER_SHIPPING?t.push({label:"Level-Shipping",value:this.$ENV.EXCLUSIVE.LEVEL_SHIPPING}):t.push({label:"Level-Product",value:this.$ENV.EXCLUSIVE.LEVEL_PRODUCT})}else o&&t.push({label:"Level-Gift",value:this.$ENV.EXCLUSIVE.LEVEL_GIFT});this.$store.commit("promotion/setExclusives",t)},editInfo:function(){this.isEditInfo=!this.isEditInfo,this.$refs["promotionInfo"].editMode()},getPromotionDetail:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$store.dispatch("promotion_detail/getPromotionInfo").then((function(e){t.loading=!1,200!=e.status?t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when getting promotion, please try again",type:"danger"}):t.headerStyle="min-height: 55vh; background-size: cover; background-position: center top; background-image: url("+t.promotionDetail.imgUrl+"); "})).catch((function(e){console.log(e),t.loading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Error when getting promotion, please try again",type:"danger"})}));case 3:case"end":return e.stop()}}),e)})))()},loadingStatus:function(t){this.loading=t}}},vt=gt,bt=(o("0209"),Object(g["a"])(vt,i,a,!1,null,null,null));e["default"]=bt.exports},"5deb":function(t,e,o){"use strict";o("400b")},"62b4":function(t,e,o){},6981:function(t,e,o){
/*!
 * clipboard.js v2.0.6
 * https://clipboardjs.com/
 * 
 * Licensed MIT © Zeno Rocha
 */
!function(e,o){t.exports=o()}(0,(function(){return o={},t.m=e=[function(t,e){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var o=t.hasAttribute("readonly");o||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),o||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),a=document.createRange();a.selectNodeContents(t),i.removeAllRanges(),i.addRange(a),e=i.toString()}return e}},function(t,e){function o(){}o.prototype={on:function(t,e,o){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:o}),this},once:function(t,e,o){var i=this;function a(){i.off(t,a),e.apply(o,arguments)}return a._=e,this.on(t,a,o)},emit:function(t){for(var e=[].slice.call(arguments,1),o=((this.e||(this.e={}))[t]||[]).slice(),i=0,a=o.length;i<a;i++)o[i].fn.apply(o[i].ctx,e);return this},off:function(t,e){var o=this.e||(this.e={}),i=o[t],a=[];if(i&&e)for(var n=0,r=i.length;n<r;n++)i[n].fn!==e&&i[n].fn._!==e&&a.push(i[n]);return a.length?o[t]=a:delete o[t],this}},t.exports=o,t.exports.TinyEmitter=o},function(t,e,o){var i=o(3),a=o(4);t.exports=function(t,e,o){if(!t&&!e&&!o)throw new Error("Missing required arguments");if(!i.string(e))throw new TypeError("Second argument must be a String");if(!i.fn(o))throw new TypeError("Third argument must be a Function");if(i.node(t))return m=e,p=o,(d=t).addEventListener(m,p),{destroy:function(){d.removeEventListener(m,p)}};if(i.nodeList(t))return l=t,c=e,u=o,Array.prototype.forEach.call(l,(function(t){t.addEventListener(c,u)})),{destroy:function(){Array.prototype.forEach.call(l,(function(t){t.removeEventListener(c,u)}))}};if(i.string(t))return n=t,r=e,s=o,a(document.body,n,r,s);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var n,r,s,l,c,u,d,m,p}},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var o=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===o||"[object HTMLCollection]"===o)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,o){var i=o(5);function a(t,e,o,a,n){var r=function(t,e,o,a){return function(o){o.delegateTarget=i(o.target,e),o.delegateTarget&&a.call(t,o)}}.apply(this,arguments);return t.addEventListener(o,r,n),{destroy:function(){t.removeEventListener(o,r,n)}}}t.exports=function(t,e,o,i,n){return"function"==typeof t.addEventListener?a.apply(null,arguments):"function"==typeof o?a.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return a(t,e,o,i,n)})))}},function(t,e){if("undefined"!=typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},function(t,e,o){"use strict";o.r(e);var i=o(0),a=o.n(i),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.resolveOptions(t),this.initSelection()}var l=(function(t,e,o){e&&r(t.prototype,e),o&&r(t,o)}(s,[{key:"resolveOptions",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var o=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=o+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=a()(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=a()(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(t){var e=0<arguments.length&&void 0!==t?t:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":n(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),s),c=o(1),u=o.n(c),d=o(2),m=o.n(d),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t,e,o){return e&&f(t.prototype,e),o&&f(t,o),t};function f(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(v,u.a),h(v,[{key:"resolveOptions",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===p(e.container)?e.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=m()(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return b("action",t)}},{key:"defaultTarget",value:function(t){var e=b("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return b("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(t){var e=0<arguments.length&&void 0!==t?t:["copy","cut"],o="string"==typeof e?[e]:e,i=!!document.queryCommandSupported;return o.forEach((function(t){i=i&&!!document.queryCommandSupported(t)})),i}}]),v);function v(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));return o.resolveOptions(e),o.listenClick(t),o}function b(t,e){var o="data-clipboard-"+t;if(e.hasAttribute(o))return e.getAttribute(o)}e.default=g}],t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var a in e)t.d(i,a,function(t){return e[t]}.bind(null,a));return i},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=6).default;function t(i){if(o[i])return o[i].exports;var a=o[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var e,o}))},"6cb0":function(t,e,o){"use strict";o("0b20")},"7c14":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div")},a=[],n={methods:{},beforeCreate:function(){this.$session.exists()&&this.$session.destroy(),this.$store.commit("account/setUserInfo",null),this.$router.push("/login").catch((function(){}))}},r=n,s=o("2877"),l=Object(s["a"])(r,i,a,!1,null,null,null);e["default"]=l.exports},"7e84":function(t,e,o){"use strict";o("aefc")},8542:function(t,e,o){"use strict";o("01e2")},"9cf5":function(t,e,o){},aefc:function(t,e,o){},b871:function(t,e,o){"use strict";o("4a11")},baa5:function(t,e,o){var i=o("23e7"),a=o("e58c");i({target:"Array",proto:!0,forced:a!==[].lastIndexOf},{lastIndexOf:a})},c067:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"font-size":"1.25rem"},attrs:{id:"action-detail"}},[o("div",{},[o("div",{staticClass:"pb-2"},[o("el-form",{ref:"actionDetailForm",attrs:{model:t.action,rules:t.actionRules}},[o("el-row",[o("el-col",{staticClass:"pb-1 ml-2",attrs:{span:24}},[o("el-row",[o("el-form-item",{staticClass:"mb-2",attrs:{prop:"name",label:"Name"}},[o("el-input",{staticClass:"pb-0",attrs:{type:"text",label:"Action Name",placeholder:"Input name here",maxlength:"100",spellcheck:"false","show-word-limit":""},model:{value:t.action.name,callback:function(e){t.$set(t.action,"name",e)},expression:"action.name"}})],1)],1)],1),o("el-col",{attrs:{span:24}},[t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_AMOUNT?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" discount ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"discountAmount"}},[o("el-input-number",{staticClass:"drag-input-number ml-0",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:1,max:999999999},model:{value:t.action.discountAmount,callback:function(e){t.$set(t.action,"discountAmount",e)},expression:"action.discountAmount"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v(" VNĐ ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" minimum price of product after discount is ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"minPriceAfter"}},[o("el-input-number",{staticClass:"drag-input-number ml-2",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:0,max:999999999},model:{value:t.action.minPriceAfter,callback:function(e){t.$set(t.action,"minPriceAfter",e)},expression:"action.minPriceAfter"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v(" VNĐ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_PERCENT?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" discount ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"discountPercentage"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:1,max:100},model:{value:t.action.discountPercentage,callback:function(e){t.$set(t.action,"discountPercentage",e)},expression:"action.discountPercentage"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v("%")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" and maximum discount price is ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"maxAmount"}},[o("el-input-number",{staticClass:"drag-input-number ml-0",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:0,max:999999999},model:{value:t.action.maxAmount,callback:function(e){t.$set(t.action,"maxAmount",e)},expression:"action.maxAmount"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v("VNĐ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_UNIT?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" discount ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"discountQuantity"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:1,max:999999},model:{value:t.action.discountQuantity,callback:function(e){t.$set(t.action,"discountQuantity",e)},expression:"action.discountQuantity"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v(" unit(s) of products in cart ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_FIXED?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" fixed price ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"fixedPrice"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:1,max:999999999},model:{value:t.action.fixedPrice,callback:function(e){t.$set(t.action,"fixedPrice",e)},expression:"action.fixedPrice"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v(" VNĐ ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_LADDER?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" buy product at the price ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"ladderPrice"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:99999999},model:{value:t.action.ladderPrice,callback:function(e){t.$set(t.action,"ladderPrice",e)},expression:"action.ladderPrice"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v(" VNĐ ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" since the ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"orderLadderProduct"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:10},model:{value:t.action.orderLadderProduct,callback:function(e){t.$set(t.action,"orderLadderProduct",e)},expression:"action.orderLadderProduct"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v(" product ")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.PRODUCT_BUNDLE?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" with the price")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"bundlePrice"}},[o("el-input-number",{staticClass:"drag-input-number ml-0",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:999999999},model:{value:t.action.bundlePrice,callback:function(e){t.$set(t.action,"bundlePrice",e)},expression:"action.bundlePrice"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v("VNĐ")])],1),o("el-col",{staticClass:"ml-1 mb-1",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0"},[t._v(" for products in ")]),o("el-button",{staticClass:"ml-1",staticStyle:{outline:"none",border:"0px","font-size":"1rem"},attrs:{type:"text",plain:""},on:{click:function(e){return t.openDrawerProduct(t.productSelection)}}},[t._v("selection list ("+t._s(t.productSelection.length)+") ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.ORDER_AMOUNT?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" discount ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"discountAmount"}},[o("el-input-number",{staticClass:"drag-input-number ml-0",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:999999999},model:{value:t.action.discountAmount,callback:function(e){t.$set(t.action,"discountAmount",e)},expression:"action.discountAmount"}})],1),o("label",{staticClass:"ml-1 mb-0"},[t._v(" VNĐ for cart")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" minimum price of cart after discount is ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"minPriceAfter"}},[o("el-input-number",{staticClass:"drag-input-number ml-0",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:0,max:999999999},model:{value:t.action.minPriceAfter,callback:function(e){t.$set(t.action,"minPriceAfter",e)},expression:"action.minPriceAfter"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v(" VNĐ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.ORDER_PERCENT?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mr-2 mb-0"},[t._v(" discount ")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"discountPercentage"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"number",size:"small",min:1,max:100},model:{value:t.action.discountPercentage,callback:function(e){t.$set(t.action,"discountPercentage",e)},expression:"action.discountPercentage"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v(" % for cart")])],1),o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v("maximum discount price")]),o("el-form-item",{staticClass:"mb-2",attrs:{prop:"maxAmount"}},[o("el-input-number",{staticClass:"drag-input-number",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:0,max:999999999},model:{value:t.action.maxAmount,callback:function(e){t.$set(t.action,"maxAmount",e)},expression:"action.maxAmount"}})],1),o("label",{staticClass:"ml-2 mb-0"},[t._v("VNĐ")])],1)],1)],1):t._e(),t.action.actionType==t.$ENV.ACTION_TYPE.ORDER_SHIPPING?o("div",[o("el-row",[o("el-col",{staticClass:"ml-1 mb-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider pb-2",attrs:{direction:"vertical"}}),o("span",[o("label",{staticClass:"mr-2 mb-0"},[t._v(" discount ")])]),o("el-select",{staticStyle:{width:"8vw"},attrs:{size:"small"},on:{change:t.changeShipDiscount},model:{value:t.isShipAmount,callback:function(e){t.isShipAmount=e},expression:"isShipAmount"}},[o("el-option",{key:"shipAmount",attrs:{label:"amount",value:!0}}),o("el-option",{key:"shipPercent",attrs:{label:"percentage",value:!1}})],1),t.isShipAmount?o("span",[o("el-form-item",{staticClass:"mb-0 mr-0 ml-2",attrs:{prop:"discountAmount"}},[o("el-input-number",{staticClass:"drag-input-number mr-2",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:999999999},model:{value:t.action.discountAmount,callback:function(e){t.$set(t.action,"discountAmount",e)},expression:"action.discountAmount"}}),o("label",{staticClass:"mb-0"},[t._v(" VNĐ for shipping fee of cart")])],1)],1):t._e(),t.isShipAmount?t._e():o("span",{staticClass:"row align-items-center ml-1"},[o("el-form-item",{staticClass:"mb-0 mr-0 ml-2",attrs:{prop:"discountPercentage"}},[o("el-input-number",{staticClass:"drag-input-number mr-2",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:1,max:100},model:{value:t.action.discountPercentage,callback:function(e){t.$set(t.action,"discountPercentage",e)},expression:"action.discountPercentage"}})],1),o("label",{staticClass:"mb-0"},[t._v(" % for shipping fee of cart")])],1)],1),t.isShipAmount?t._e():o("el-col",{staticClass:"ml-1 mb-1 mt-1 row align-items-center",attrs:{span:24}},[o("el-divider",{staticClass:"custom-divider pb-2",attrs:{direction:"vertical"}}),o("label",{staticClass:"mb-0 mr-2"},[t._v(" maximum discount price is ")]),o("el-form-item",{staticClass:"mb-0",attrs:{prop:"maxAmount"}},[o("el-input-number",{staticClass:"drag-input-number ml-0 mb-0",staticStyle:{width:"10vw"},attrs:{type:"text",size:"small",min:0,max:999999999},model:{value:t.action.maxAmount,callback:function(e){t.$set(t.action,"maxAmount",e)},expression:"action.maxAmount"}})],1),o("label",{staticClass:"mb-0 ml-2"},[t._v("VNĐ")])],1)],1)],1):t._e()]),o("el-col",[o("el-row",{attrs:{type:"flex",justify:"end"}},[o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-document-checked"},on:{click:t.updateAction}},[t._v(" Update Action ")])],1)],1)],1)],1)],1)]),o("el-drawer",{directives:[{name:"show",rawName:"v-show",value:t.drawer,expression:"drawer"}],staticClass:"drawer",attrs:{id:"action-detail-drawer","append-to-body":!0,"before-close":t.handleCloseDrawer,visible:t.drawer,size:"50%",direction:"rtl"},on:{"update:visible":function(e){t.drawer=e}}},[o("div",{staticClass:"m-3"},[o("h3",[t._v("Product list")]),o("label",{staticClass:"custom-tag"},[o("i",{staticClass:"el-icon-warning-outline mr-1"}),t._v(" Selected "),o("b",[t._v(t._s(t.productSelection.length))]),t._v(" product(s) ")]),o("el-table",{ref:"multipleTable",attrs:{data:t.products,border:"",height:"400"},on:{"selection-change":t.handleSelectionChange},model:{value:t.productSelection,callback:function(e){t.productSelection=e},expression:"productSelection"}},[o("el-table-column",{attrs:{type:"selection"}}),o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{property:"productName",width:"250",label:"Product name"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticClass:"custom-content-break"},[t._v(" "+t._s(e.row.productName)+" ")])]}}])}),o("el-table-column",{attrs:{property:"productCode",label:"Product code",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{staticClass:"custom-content-break text-black",attrs:{type:"info",effect:"plain"}},[t._v(" "+t._s(e.row.code))])]}}])}),o("el-table-column",{attrs:{property:"cateName",label:"Category"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("label",{staticClass:"custom-content-break"},[t._v(" "+t._s(e.row.cateName)+" ")])]}}])}),t.action.actionType!=t.$ENV.ACTION_TYPE.PRODUCT_UNIT?o("el-table-column",{attrs:{label:"Quantity"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-input-number",{attrs:{min:1,max:10},model:{value:e.row.quantity,callback:function(o){t.$set(e.row,"quantity",o)},expression:"scope.row.quantity"}})]}}],null,!1,1266599470)}):t._e()],1),o("el-col",{attrs:{span:24}},[o("el-button",{staticClass:"float-right mt-3",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.selectProduct}},[t._v("Select Product")])],1)],1)])],1)},a=[],n=(o("7db0"),o("4160"),o("159b"),o("96cf"),o("1da1")),r={props:{},data:function(){return{strategyOptions:[{value:1,name:"CHEAPEST"},{value:2,name:"MOST EXPENSIVE"},{value:3,name:"DEFAULT"}],drawer:!1,isEdit:!1,loading:!1,action:{actionType:0,discountQuantity:0,discountAmount:0,discountPercentage:0,fixedPrice:0,maxAmount:0,minPriceAfter:0,orderLadderProduct:0,ladderPrice:0,bundlePrice:0,bundleQuantity:0,bundleStrategy:0},actionRules:{name:[{required:!0,trigger:["blur","change"],message:"Please input name!"}],discountAmount:[{required:!0,trigger:["blur","change"],message:"Please input the amount!"}],minPriceAfter:[{required:!0,trigger:["blur","change"],message:"Please input the minimum price of product!"}],discountPercentage:[{required:!0,trigger:["blur","change"],message:"Please input the percentage!"}],maxAmount:[{required:!0,trigger:["blur","change"],message:"Please input the maximum discount price!"}],discountQuantity:[{required:!0,trigger:["blur","change"],message:"Please input the quantity of product to discount!"}],fixedPrice:[{required:!0,trigger:["blur","change"],message:"Please input the price!"}],ladderPrice:[{required:!0,trigger:["blur","change"],message:"Please input the price!"}],orderLadderProduct:[{required:!0,trigger:["blur","change"],message:"Please input the order of product!"}],bundleQuantity:[{required:!0,trigger:["blur","change"],message:"Please input the quantity of product in bundle!"}],bundlePrice:[{required:!0,trigger:["blur","change"],message:"Please input the price!"}],bundleStrategy:[{required:!0,trigger:["blur","change"],message:"Please input the price!"}]},shippingOption:"1",productSelection:[],isShipAmount:!0,CONSTANT:this.$ENV}},computed:{actions:function(){return this.action},products:function(){return this.$store.state.condition.products},actionParam:function(){return this.$store.state.action.actionParam}},methods:{editMode:function(){this.isEdit=!this.isEdit,this.isEdit||this.getActionDetail()},handleSelectionChange:function(t){this.productSelection=t},selectProduct:function(){var t=!0;this.action.actionType!=this.$ENV.ACTION_TYPE.PRODUCT_UNIT&&(t=this.validGiftQuantity()),t?this.drawer=!1:this.$notify({icon:"el-icon-warning",title:"Error",message:"Please input quantity",type:"warning"})},validGiftQuantity:function(){var t=!0;return this.productSelection.forEach((function(e){void 0!=e.quantity&&0!=e.quantity||(t=!1)})),t},openDrawerProduct:function(){this.drawer=!0,this.$nextTick((function(){var t=this;this.productSelection.forEach((function(e){var o=t.products.find((function(t){return t.productId==e.productId}));o.quantity=e.quantity,t.$refs["multipleTable"].toggleRowSelection(o,!0)}))}))},setupData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.getActionDetail();case 3:return e.next=5,t.getProductList();case 5:t.setupAction(),t.loading=!1;case 7:case"end":return e.stop()}}),e)})))()},setupAction:function(){var t=this;this.loading=!0,this.productSelection=[],this.action=this.actionParam,this.action.actionType==this.$ENV.ACTION_TYPE.ORDER_SHIPPING&&(this.isShipAmount=this.action.discountAmount>0),this.action.listProduct=[],this.productSelection=this.actionParam.listProductMapp,this.actionParam.listProductMapp&&this.actionParam.listProductMapp.forEach((function(e){t.action.listProduct.push(e.productId)})),this.loading=!1},getActionDetail:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("action/getActionDetail").then((function(e){200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get information",type:"warning"})})).catch((function(e){console.log(e),t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get information",type:"warning"})}));case 2:case"end":return e.stop()}}),e)})))()},handleCloseDrawer:function(){var t=this;this.action.listProduct=[],this.productSelection.length>0&&this.productSelection.forEach((function(e){t.action.listProduct.push(e.productId)})),this.drawer=!1},getProductList:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("condition/getBrandProduct").then((function(e){200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Product error !",type:"danger"})})).catch((function(){t.$notify({icon:"el-icon-warning",title:"Error",message:"Get Product error !",type:"danger"})}));case 2:case"end":return e.stop()}}),e)})))()},handleActionUpdate:function(t){if(t.actionType!=this.$ENV.ACTION_TYPE.PRODUCT_UNIT&&t.actionType>=this.$ENV.ACTION_TYPE.PRODUCT_AMOUNT){if(0==this.productSelection.length)return void this.$notify({icon:"el-icon-warning",title:"Error",message:"Please select product",type:"danger"});t.listProduct=[],t.listProductMapp=[],this.productSelection.forEach((function(e){var o={productId:e.productId,quantity:e.quantity};t.listProduct.push(o)}))}return t},updateAction:function(){var t=this;this.$refs["actionDetailForm"].validate((function(e){if(e){t.loading=!0;var o=t.handleActionUpdate(t.action);o&&(t.$store.commit("action/setUpdAction",o),t.$store.dispatch("action/updateAction").then((function(e){t.loading=!1,200==e.status?t.$notify({icon:"el-icon-warning",title:"Success",message:"Update success, please try again",type:"success"}):t.$notify({icon:"el-icon-warning",title:"Error",message:"Update failed, please try again",type:"danger"})})).catch((function(){t.loading=!1,t.$notify({icon:"el-icon-warning",title:"Error",message:"Update failed, please try again",type:"danger"})})))}}))}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.setupData();case 2:case"end":return e.stop()}}),e)})))()}},s=r,l=(o("dd7b"),o("2877")),c=Object(l["a"])(s,i,a,!1,null,null,null);e["default"]=c.exports},c78a:function(t,e,o){},d172:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"min-height":"70vh"}},[o("base-header",{staticClass:"pb-6 mb-3 pt-1",attrs:{type:"gradient-success"}}),o("div",{staticClass:"container-fluid"},[o("el-card",[o("h2",[t._v("CONDITION BUILDER")]),o("el-divider",{staticClass:"mt-3 mb-3"}),o("el-col",{staticClass:"mb-3",attrs:{span:24}},[o("el-tag",{staticClass:"custom-tag-content",attrs:{type:"warning"}},[o("i",{staticClass:"el-icon-warning-outline mr-2"}),o("label",[t._v(t._s(t.$ENV.TEXT_EXPLAIN.Condition))])])],1),o("el-form",{ref:"ruleForm",attrs:{"label-width":"200",rules:t.myRule,model:t.conditionRule,"label-position":"left"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"ruleName",label:"Name"}},[o("el-input",{attrs:{maxlength:50,"show-word-limit":""},model:{value:t.conditionRule.ruleName,callback:function(e){t.$set(t.conditionRule,"ruleName",e)},expression:"conditionRule.ruleName"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Description",prop:"description"}},[o("el-input",{attrs:{rows:4,resize:"none",type:"textarea","show-word-limit":"",maxlength:200},model:{value:t.conditionRule.description,callback:function(e){t.$set(t.conditionRule,"description",e)},expression:"conditionRule.description"}})],1)],1)],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("el-card",[o("drag-item-section",{ref:"dragSection",attrs:{conditionItem:t.conditionItem}})],1)],1),o("el-col",{attrs:{span:18}},[o("el-card",[o("drop-section",{ref:"dropSection",attrs:{conditionItemParam:t.conditionItem}})],1)],1)],1),o("el-row",[o("el-button",{staticClass:"mt-3 float-right",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.newRule}},[t._v("New Rule")])],1)],1)],1)],1)},a=[],n=(o("7db0"),o("4160"),o("b0c0"),o("498a"),o("159b"),o("53ca")),r=o("2f68"),s=o("bfce"),l={name:"condition-form",components:{DragItemSection:r["a"],DropSection:s["a"]},created:function(){this.getProducts()},data:function(){var t=function(t,e,o){0==e.trim().length?o(new Error("Please input name")):o()},e=function(t,e,o){0==e.trim().length?o(new Error("Please input description")):o()};return{myRule:{description:[{required:!0,trigger:["blur","change"],message:"Please input description"},{validator:e,trigger:["blur","change"]}],ruleName:[{required:!0,trigger:["blur","change"],message:"Please input name"},{validator:t,trigger:["blur","change"]}]},CONSTANT:this.$ENV,formIndex:0,loading:!1,promotionType:!0,isSaved:!1,conditionItem:[],conditionRule:{ruleName:"",description:"",brandId:"",conditionGroup:[]}}},computed:{conditions:function(){return this.$store.state.condition.conditions},requestParam:function(){return this.$store.state.condition.requestParam}},methods:{getProducts:function(){var t=this;this.$store.dispatch("condition/getBrandProduct").then((function(e){200!=e.status&&t.$notify({title:"Warning",message:"Cannot get Products",type:"warning"})})).catch((function(){t.$notify({title:"Warning",message:"Cannot get Products",type:"warning"})}))},newRule:function(){var t=this;this.$refs["ruleForm"].validate((function(e){if(e){t.loading=!0;var o=t.conditionItem,i=t.handleCondition(o);if(i){var a=t.conditionRule;a.brandId=t.$store.state.condition.brandId,a.conditionGroup=i,t.$store.commit("condition/setInsertConditionDto",a),t.$store.dispatch("condition/insertConditionRule").then((function(e){t.loading=!1,200==e.status?(t.$notify({title:"Success",message:"Create successful",type:"success"}),t.$router.push("/campaign/condition")):(t.loading=!1,t.$notify({title:"Warning",message:"Create error",type:"warning"}))})).catch((function(){t.loading=!1,t.$notify({title:"Warning",message:"Create error",type:"warning"})}))}else t.loading=!1}}))},handleCondition:function(t){var e=this,o=this.CONSTANT.CONTAIN_CODE,i=this.CONSTANT.OPERATOR;if(0!=t.length){for(var a=[],r=function(n){var r=t[n];if(void 0!=r.condType){var s=r.condType,l={groupNo:n,nextOperator:r.nextOperator,orderCondition:[],productCondition:[]};switch(s){case"PRODUCT":if(void 0!=r.productList&&r.productList.length>0){var c={productConditionType:void 0!=r.productConditionType?r.productConditionType:o.INCLUDE,productQuantity:void 0!=r.productQuantity?r.productQuantity:0,quantityOperator:void 0!=r.quantityOperator?i.find((function(t){return t.id==r.quantityOperator})).name:i.find((function(t){return 1==t.id})).name,nextOperator:r.nextOperator,indexGroup:0,productConditionMapping:[]};r.productList.forEach((function(t){var e={productId:t.productId,insDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"})};c.productConditionMapping.push(e)})),l.productCondition.push(c);break}return e.$notify({title:"Warning",message:"Please select product for condition",type:"warning"}),{v:void 0};case"ORDER":var u={quantity:void 0!=r.quantity?r.quantity:0,quantityOperator:void 0!=r.quantityOperator?i.find((function(t){return t.id==r.quantityOperator})).name:i.find((function(t){return 1==t.id})).name,amount:void 0!=r.amount?r.amount:0,amountOperator:void 0!=r.amountOperator?i.find((function(t){return t.id==r.amountOperator})).name:i.find((function(t){return 1==t.id})).name,nextOperator:r.nextOperator,indexGroup:0};l.orderCondition.push(u);break}a.push(l)}else{var d={groupNo:n,nextOperator:r.nextOperator,orderCondition:[],productCondition:[]};if(0==r.tasks.length)return e.$notify({title:"Warning",message:"Please select condition for group",type:"warning"}),{v:void 0};for(var m=function(t){var e=r.tasks[t],a=e.condType;switch(a){case"PRODUCT":var n={productConditionType:void 0!=e.productConditionType?e.productConditionType:o.INCLUDE,productQuantity:void 0!=e.productQuantity?e.productQuantity:0,quantityOperator:void 0!=e.quantityOperator?i.find((function(t){return t.id==e.quantityOperator})).name:i.find((function(t){return 1==t.id})).name,nextOperator:e.nextOperator,indexGroup:t,productConditionMapping:[]};e.productList.forEach((function(t){var e={productId:t.productId,insDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"}),updDate:(new Date).toLocaleString("vn",{timeZone:"Asia/Ho_Chi_Minh"})};n.productConditionMapping.push(e)})),d.productCondition.push(n);break;case"ORDER":var s={quantity:void 0!=e.quantity?e.quantity:0,quantityOperator:void 0!=e.quantityOperator?i.find((function(t){return t.id==e.quantityOperator})).name:i.find((function(t){return 1==t.id})).name,amount:void 0!=e.amount?e.amount:0,amountOperator:void 0!=e.amountOperator?i.find((function(t){return t.id==e.amountOperator})).name:i.find((function(t){return 1==t.id})).name,nextOperator:e.nextOperator,indexGroup:t};d.orderCondition.push(s);break}},p=0;p<r.tasks.length;p++)m(p);a.push(d)}},s=0;s<t.length;s++){var l=r(s);if("object"===Object(n["a"])(l))return l.v}return a}this.$notify({title:"Warning",message:"Please select condition",type:"warning"})}}},c=l,u=(o("44de1"),o("09bb"),o("2877")),d=Object(u["a"])(c,i,a,!1,null,"459bb968",null);e["default"]=d.exports},d603:function(t,e,o){"use strict";o("d6dd")},d6dd:function(t,e,o){},d7f6:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"justify-content"},[o("h1",[t._v("Sorry this link has expired")])])}],n={name:"forbidden"},r=n,s=o("2877"),l=Object(s["a"])(r,i,a,!1,null,null,null);e["default"]=l.exports},d997:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"voucherForm"}},[o("base-header",{staticClass:"pb-6 mb-3 pt-1",attrs:{type:"gradient-success"}}),o("div",{staticClass:"container-fluid mt-3"},[o("el-card",[o("el-row",[o("voucher-type",{directives:[{name:"show",rawName:"v-show",value:0==t.formIndex,expression:"formIndex == 0"}],ref:"voucherType",attrs:{promotionId:t.promotionId}})],1),o("el-row",{staticClass:"mt-2"},[o("el-col",{attrs:{span:24}},[o("el-button",{staticClass:"mt-3 float-right",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.finish}},[t._v("New Voucher ")])],1)],1)],1)],1)],1)},a=[],n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"voucherBuilder"}},[o("el-row",{attrs:{id:"voucher"}},[o("div",{staticClass:"bg-transparent"},[o("el-row",{attrs:{type:"flex",justify:"space-between"}},[o("el-col",{attrs:{span:21}},[o("h1",{staticClass:"voucher-builder"},[o("b-icon",{attrs:{scale:"0.9",icon:"tag-fill"}}),t._v(" VOUCHER GROUP BUILDER ")],1)]),o("el-col",{attrs:{span:3}},[o("a",{staticClass:"float-right",attrs:{href:"#"}},[o("i",{staticClass:"el-icon-question"}),t._v(" "),o("span",[t._v("Get Help")])])])],1)],1)]),o("el-col",{staticClass:"mt-2 mb-3",attrs:{span:24}},[o("label",{staticClass:"custom-tag-content"},[o("i",{staticClass:"el-icon-warning-outline mr-2"}),t._v(t._s(t.$ENV.TEXT_EXPLAIN.Voucher))])]),o("el-form",{ref:"voucherForm",attrs:{model:t.voucherForm,id:"voucherType","label-position":t.labelPosition,rules:t.rules}},[o("el-collapse-transition",[o("div",[o("div",{staticClass:"mt-3 pt-3 pb-2"},[o("div",{staticClass:"bg-transparent"},[o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:12}},[o("div",{staticClass:"card p-2",staticStyle:{margin:"0px","min-height":"270px"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{prop:"groupName"}},[o("template",{slot:"label"},[o("label",{attrs:{for:""}},[o("h4",{staticClass:"font-weight-normal align-bottom mb-0"},[t._v(" Group Name ")])])]),o("el-input",{attrs:{maxlength:100},model:{value:t.voucherForm.groupName,callback:function(e){t.$set(t.voucherForm,"groupName",e)},expression:"voucherForm.groupName"}})],2)],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"codeLength"}},[o("template",{slot:"label"},[o("label",[o("h4",{staticClass:"font-weight-normal align-bottom mb-0"},[t._v(" Length ")])])]),o("el-col",{staticClass:"pl-0 pr-0"},[o("el-input-number",{attrs:{max:30,min:1,type:"number"},on:{change:t.handleChangeCodeLength},model:{value:t.voucherForm.codeLength,callback:function(e){t.$set(t.voucherForm,"codeLength",e)},expression:"voucherForm.codeLength"}})],1)],2)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{staticClass:"mb-0",attrs:{prop:"quantity"}},[o("template",{slot:"label"},[o("label",[o("h4",{staticClass:"font-weight-normal align-bottom mb-0"},[t._v(" Quantity ")])])]),o("el-col",{staticClass:"pl-0 pr-0"},[o("el-input-number",{attrs:{disabled:2==t.voucherForm.voucherType,min:1,max:t.maximumRandomCode,type:"number"},model:{value:t.voucherForm.quantity,callback:function(e){t.$set(t.voucherForm,"quantity",e)},expression:"voucherForm.quantity"}}),o("el-row",{staticClass:"maximum-code"},[o("div",{directives:[{name:"show",rawName:"v-show",value:"2"!=t.voucherForm.voucherType,expression:"voucherForm.voucherType != '2'"}]},[o("el-col",[o("b",[t._v(" Maximum quantity of voucher: ")]),t._v(" "+t._s(t.maximumRandomCode)+" ")])],1)])],1)],2)],1)],1)],1)]),o("el-col",{attrs:{span:12}},[o("div",{staticClass:"card p-2",staticStyle:{"min-height":"270px"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("label",[t._v("Action type")]),o("el-radio-group",{on:{change:t.changeSelectAction},model:{value:t.isAction,callback:function(e){t.isAction=e},expression:"isAction"}},[o("el-radio-button",{attrs:{label:!0}},[t._v("Discount Action")]),o("el-radio-button",{attrs:{label:!1}},[t._v("Gift Action")])],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"actionId",label:"Discount action"}},[o("el-select",{attrs:{disabled:!t.isAction},model:{value:t.voucherForm.actionId,callback:function(e){t.$set(t.voucherForm,"actionId",e)},expression:"voucherForm.actionId"}},t._l(t.actions,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.actionId}})})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"giftId",label:"Gift action"}},[o("el-select",{attrs:{disabled:t.isAction},model:{value:t.voucherForm.giftId,callback:function(e){t.$set(t.voucherForm,"giftId",e)},expression:"voucherForm.giftId"}},t._l(t.gifts,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.giftId}})})),1)],1)],1)],1)],1)])],1),o("el-row",[o("el-checkbox",{staticClass:"h4",attrs:{disabled:t.typeBlock},on:{change:t.changeAdvance},model:{value:t.isAdvanced,callback:function(e){t.isAdvanced=e},expression:"isAdvanced"}},[t._v(" Advanced settings ")])],1)],1)])])]),o("el-collapse-transition",[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdvanced,expression:"isAdvanced"}]},[o("div",{staticClass:"card mt-3"},[o("div",{staticClass:"card-header bg-transparent"},[o("el-row",[o("h2",[t._v("Advanced settings")]),o("el-col",{staticClass:"mt-2 mb-2",attrs:{span:24}},[o("label",{staticClass:"custom-tag-content"},[o("i",{staticClass:"el-icon-warning-outline mr-2"}),t._v(t._s(t.$ENV.TEXT_EXPLAIN.Voucher))])])],1),o("el-row",{attrs:{type:"flex",gutter:20,justify:"space-between"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Charset"}},[o("el-select",{attrs:{placeholder:"Alphannumetic"},on:{input:t.handleChangeCharset,blur:t.handleChangeCharset},model:{value:t.voucherForm.charset,callback:function(e){t.$set(t.voucherForm,"charset",e)},expression:"voucherForm.charset"}},t._l(t.charsetMapping,(function(t){return o("el-option",{key:t.type,attrs:{label:t.type,value:t.type}})})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Sample",prop:"sample"}},[o("el-input",{staticClass:"text-dark",attrs:{disabled:"Custom"!=t.voucherForm.charset,maxlength:62},on:{change:t.handleCustomcharset},model:{value:t.sample,callback:function(e){t.sample=e},expression:"sample"}})],1)],1)],1),o("el-row",{attrs:{type:"flex",gutter:20,justify:"space-between"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Prefix",prop:"prefix"}},[o("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:t.voucherForm.prefix,callback:function(e){t.$set(t.voucherForm,"prefix",e)},expression:"voucherForm.prefix"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"Postfix",prop:"postfix"}},[o("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:t.voucherForm.postfix,callback:function(e){t.$set(t.voucherForm,"postfix",e)},expression:"voucherForm.postfix"}})],1)],1)],1)],1)])])])],1)],1)},r=[],s=(o("7db0"),o("4160"),o("c975"),o("baa5"),o("159b"),o("96cf"),o("1da1")),l={watch:{sample:function(){this.handleChangeCharset("Custom"),console.log(this.sample),this.voucherForm.customCharset=this.sample}},props:{promotionId:String},data:function(){var t=this,e=function(e,o,i){t.voucherForm.isUnLimit?i():o?o<=0?i(new Error("Please input a positive number more than zero!")):o>t.maximumRandomCode?i(new Error("Please input a number smaller than the maximum quantity")):i():i(new Error("Please input your quantity"))},o=function(e,o,i){"2"==t.voucherForm.voucherType?o?i():i(new Error("Please input your custom code")):i()},i=function(e,o,i){t.voucherForm.isUnLimit?i():o?o<=0?i(new Error("Please input a positive number more than zero!")):o>30?i(new Error("Code length can be maximum 30 chars")):i():i(new Error("Please input your code length"))},a=function(e,o,i){t.isAction&&""==t.voucherForm.actionId?i(new Error("Please select action")):i()},n=function(e,o,i){t.isAction?i():""==t.voucherForm.giftId?i(new Error("Please select gift")):i()},r=function(e,o,i){""==t.voucherForm.customCharset&&i(new Error("Please input charset"));for(var a=0;a<t.charset;a++)t.charset.indexOf(t.charset[a])!==t.charset.lastIndexOf(t.charset[a])&&i(new Error("Characters in charset must be not the same"));i()};return{isAction:!0,loading:!1,labelPosition:"top",isAdvanced:!1,isCreateVoucher:"1",loadingVoucherGroup:!1,charsetType:"",sample:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",voucherGroup:"",maxQuantity:1e4,maximumRandomCode:62,voucherForm:{voucherType:1,charset:"Alphanumeric",prefix:"",postfix:"",groupName:"",customCharset:this.sample,customCode:"",quantity:1,isUnLimit:!1,codeLength:1,actionId:"",giftId:""},rules:{sample:[{validator:r,trigger:["blur","change"]}],actionId:[{validator:a,message:"Please select discount action",trigger:["blur","change"]}],giftId:[{validator:n,message:"Please select gift action",trigger:["blur","change"]}],customCode:[{validator:o,trigger:["blur","change"]}],groupName:[{required:!0,message:"Please enter Voucher Group Name",trigger:["blur","change"]}],quantity:[{required:!0,validator:e,trigger:["change","blur"]}],prefix:[{max:10,trigger:["change","blur"]}],postfix:[{max:10,trigger:["change","blur"]}],codeLength:[{required:!0,validator:i,trigger:["change","blur"]}]},voucherList:[],charsetMapping:[{type:"Alphanumeric",sample:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"},{type:"Alphabetic",sample:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"},{type:"Alphabetic Lowercase",sample:"abcdefghijklmnopqrstuvwxyz"},{type:"Alphabetic Uppercase",sample:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},{type:"Numbers",sample:"0123456789"},{type:"Custom",sample:""}]}},created:function(){},computed:{quantityBlock:function(){return 0==this.maximumRandomCode},actions:function(){return this.$store.state.action.actionList},gifts:function(){return this.$store.state.gift.giftList},conditions:function(){return this.$store.state.condition.conditionForVoucher},typeBlock:function(){return"2"==this.voucherForm.voucherType}},methods:{handleCustomcharset:function(t){""==t?this.maximumRandomCode=0:(this.charsetMapping.find((function(t){return"Custom"==t.type})).sample=t,this.countQuantity("Custom"))},changeSelectAction:function(){this.$refs["voucherForm"].clearValidate(["giftId","actionId"]),this.voucherForm.actionId="",this.voucherForm.giftId=""},changeAdvance:function(){this.voucherForm.charset="Alphanumeric",this.handleChangeCharset("Alphanumeric")},handleChangeCharset:function(t){var e=this;t&&(this.charsetMapping.forEach((function(o){o.type==t&&"Custom"!=o.type?(e.voucherForm.charset=o.type,e.sample=o.sample):"Custom"==o.type&&(o.sample=e.sample)})),this.countQuantity(this.voucherForm.charset))},handleChangeCodeLength:function(t){console.log("handleChangeCodeLength"),t<=30&&(console.log(this.voucherForm.charset),this.countQuantity(this.voucherForm.charset))},factorial:function(t){var e=1;if(t)for(var o=1;o<=t;o++)e*=o;return e},countQuantity:function(t){var e=this;this.charsetMapping.forEach((function(o){if(o.type==t){var i=o.sample.length;e.maximumRandomCode=Math.pow(i,e.voucherForm.codeLength),console.log("maximumRandomCode ",e.maximumRandomCode),e.voucherForm.customCharset=e.sample,console.log("this.voucherForm.customCharset ",e.voucherForm.customCharset),e.maximumRandomCode=e.maximumRandomCode>e.maxQuantity?e.maxQuantity:e.maximumRandomCode}}))},handleVoucherType:function(t){this.$store.commit("voucher/setVoucherType",t),this.voucherForm.quantity=1,this.isAdvanced=!1},handleChangeUnlimit:function(){this.voucherForm.isUnLimit=!this.voucherForm.isUnLimit,this.voucherForm.quantity=1},saveVoucher:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(!e.quantityBlock){o.next=3;break}return e.$notify({icon:"el-icon-circle-check",title:"Error",message:"Invalid quantity",type:"danger"}),o.abrupt("return");case 3:e.$refs[t].validate((function(t){if(console.log("valid",t),t){e.loading=!0;var o=e.promotionId;return e.$store.commit("voucher/setVoucherForm",e.voucherForm),void 0!==o&&""!==o&&e.$store.commit("voucher/setPromotionId",o),e.$store.dispatch("voucher/saveVoucherGroup").then((function(t){return 200==t.status?(e.$notify({icon:"el-icon-circle-check",title:"Success",message:"Creating vouchers, please wait",type:"success"}),e.$store.commit("voucher/setPageIndex",1),e.$store.commit("voucher/setSearchContent",""),e.$router.push("/voucher")):e.$notify({icon:"el-icon-warning",title:"Error",message:t.data.message,type:"danger"}),e.loading=!1,t})).catch((function(t){throw e.loading=!1,e.$notify({icon:"el-icon-warning",title:"Error",message:t.message,type:"danger"}),t}))}return e.$notify({icon:"el-icon-warning",title:"Error",message:"Please input required fields",type:"danger"}),!1}));case 4:case"end":return o.stop()}}),o)})))()}}},c=l,u=(o("6cb0"),o("48e7"),o("2877")),d=Object(u["a"])(c,n,r,!1,null,"cf441cf6",null),m=d.exports,p={name:"voucher-form",components:{VoucherType:m},created:function(){this.getActionForVoucher(),this.getPostActionForVoucher()},computed:{},data:function(){return{formIndex:0,loading:!1,promotionType:!0,isSaved:!1,promotionId:this.$route.params.promotionId}},methods:{getPostActionForVoucher:function(){var t=this;this.$store.commit("action/setPageIndexPost",0),this.$store.commit("action/setPageSizePost",0),this.$store.commit("action/setPostActionType",0),this.$store.dispatch("gift/getPostActionList").then((function(e){t.$store.commit("action/setPageIndexPost",1),t.$store.commit("action/setPageSizePost",10),200!=e.status&&t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get post action",type:"danger"})})).catch((function(){t.$store.commit("action/setPageIndexPost",1),t.$store.commit("action/setPageSizePost",10),t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get post action",type:"danger"})}))},getActionForVoucher:function(){var t=this;this.$store.commit("action/setPageIndexAction",0),this.$store.commit("action/setPageSizeAction",0),this.$store.commit("action/setNewActionType",0),this.$store.dispatch("action/getAction").then((function(e){200!=e.status&&(t.$store.commit("action/setPageIndexAction",1),t.$store.commit("action/setPageSizeAction",10),t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get action",type:"danger"}))})).catch((function(){t.$store.commit("action/setPageIndexAction",1),t.$store.commit("action/setPageSizeAction",10),t.$notify({icon:"el-icon-warning",title:"Error",message:"Cannot get action",type:"danger"})}))},redirectVoucherTable:function(){},finish:function(){this.$refs.voucherType.saveVoucher("voucherForm")}}},h=p,f=(o("28d8"),Object(u["a"])(h,i,a,!1,null,null,null));e["default"]=f.exports},dd7b:function(t,e,o){"use strict";o("9cf5")},e38d:function(t,e,o){},e58c:function(t,e,o){"use strict";var i=o("fc6a"),a=o("a691"),n=o("50c4"),r=o("a640"),s=o("ae40"),l=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,d=r("lastIndexOf"),m=s("indexOf",{ACCESSORS:!0,1:0}),p=u||!d||!m;t.exports=p?function(t){if(u)return c.apply(this,arguments)||0;var e=i(this),o=n(e.length),r=o-1;for(arguments.length>1&&(r=l(r,a(arguments[1]))),r<0&&(r=o+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}:c},e815:function(t,e,o){},f159:function(t,e,o){},fc32:function(t,e,o){},fc72:function(t,e,o){},fe55:function(t,e,o){}}]);
//# sourceMappingURL=chunk-69d949da.75b7e571.js.map